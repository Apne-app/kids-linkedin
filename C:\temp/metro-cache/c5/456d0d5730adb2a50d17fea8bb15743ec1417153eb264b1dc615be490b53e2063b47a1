{"dependencies":[{"name":"validate.js","data":{"isAsync":false}},{"name":"./specs.js","data":{"isAsync":false}},{"name":"./errors.js","data":{"isAsync":false}},{"name":"./client.js","data":{"isAsync":false}},{"name":"./async.js","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var validate = _$$_REQUIRE(_dependencyMap[0], \"validate.js\"),\n      specs = _$$_REQUIRE(_dependencyMap[1], \"./specs.js\"),\n      errors = _$$_REQUIRE(_dependencyMap[2], \"./errors.js\"),\n      Client = _$$_REQUIRE(_dependencyMap[3], \"./client.js\");\n\n  var StreamAnalytics = function StreamAnalytics(config) {\n    this.configure(config || {});\n  };\n\n  StreamAnalytics.prototype.configure = function (cfg) {\n    this.client = new Client(cfg);\n    this.userData = null;\n  };\n\n  StreamAnalytics.prototype.setUser = function (userData) {\n    this.userData = userData;\n  };\n\n  StreamAnalytics.prototype._sendEventFactory = function (resourceName, dataSpec) {\n    return function (eventData) {\n      var validationErrors = validate(eventData, dataSpec, {\n        format: 'flat'\n      });\n\n      if (typeof validationErrors !== 'undefined') {\n        throw new errors.InvalidInputData('event data is not valid', validationErrors);\n      }\n\n      return this._sendEvent(resourceName, eventData);\n    };\n  };\n\n  StreamAnalytics.prototype._sendEvent = function (resourceName, eventData) {\n    if (this.userData === null) {\n      throw new errors.MissingUserId('userData was not set');\n    }\n\n    eventData['user_data'] = this.userData;\n    return this.client.send(resourceName, eventData);\n  };\n\n  StreamAnalytics.prototype.trackImpression = StreamAnalytics.prototype._sendEventFactory('impression', specs.impressionSpec);\n  StreamAnalytics.prototype.trackEngagement = StreamAnalytics.prototype._sendEventFactory('engagement', specs.engagementSpec);\n  StreamAnalytics.Client = Client;\n  StreamAnalytics.errors = errors;\n  if (typeof window !== 'undefined') _$$_REQUIRE(_dependencyMap[4], \"./async.js\")(StreamAnalytics);\n  module.exports = StreamAnalytics;\n});","lineCount":49,"map":[[2,0,1,0],[2,6,1,4,"validate"],[2,14,1,12],[2,17,1,15,"require"],[2,28,1,22],[2,62,1,0],[3,0,1,0],[3,6,2,2,"specs"],[3,11,2,7],[3,14,2,10,"require"],[3,25,2,17],[3,58,1,0],[4,0,1,0],[4,6,3,2,"errors"],[4,12,3,8],[4,15,3,11,"require"],[4,26,3,18],[4,60,1,0],[5,0,1,0],[5,6,4,2,"Client"],[5,12,4,8],[5,15,4,11,"require"],[5,26,4,18],[5,60,1,0],[7,0,6,0],[7,6,6,4,"StreamAnalytics"],[7,21,6,19],[7,24,6,22],[7,33,6,4,"StreamAnalytics"],[7,48,6,22],[7,49,6,32,"config"],[7,55,6,22],[7,57,6,40],[8,0,7,2],[8,9,7,7,"configure"],[8,18,7,2],[8,19,7,17,"config"],[8,25,7,23],[8,29,7,27],[8,31,7,2],[9,0,8,1],[9,3,6,0],[11,0,10,0,"StreamAnalytics"],[11,2,10,0,"StreamAnalytics"],[11,17,10,15],[11,18,10,16,"prototype"],[11,27,10,0],[11,28,10,26,"configure"],[11,37,10,0],[11,40,10,38],[11,50,10,48,"cfg"],[11,53,10,38],[11,55,10,53],[12,0,11,2],[12,9,11,7,"client"],[12,15,11,2],[12,18,11,16],[12,22,11,20,"Client"],[12,28,11,16],[12,29,11,27,"cfg"],[12,32,11,16],[12,33,11,2],[13,0,12,2],[13,9,12,7,"userData"],[13,17,12,2],[13,20,12,18],[13,24,12,2],[14,0,13,1],[14,3,10,0],[16,0,15,0,"StreamAnalytics"],[16,2,15,0,"StreamAnalytics"],[16,17,15,15],[16,18,15,16,"prototype"],[16,27,15,0],[16,28,15,26,"setUser"],[16,35,15,0],[16,38,15,36],[16,48,15,46,"userData"],[16,56,15,36],[16,58,15,56],[17,0,16,2],[17,9,16,7,"userData"],[17,17,16,2],[17,20,16,18,"userData"],[17,28,16,2],[18,0,17,1],[18,3,15,0],[20,0,19,0,"StreamAnalytics"],[20,2,19,0,"StreamAnalytics"],[20,17,19,15],[20,18,19,16,"prototype"],[20,27,19,0],[20,28,19,26,"_sendEventFactory"],[20,45,19,0],[20,48,19,46],[20,58,19,56,"resourceName"],[20,70,19,46],[20,72,19,70,"dataSpec"],[20,80,19,46],[20,82,19,80],[21,0,21,2],[21,11,21,9],[21,21,21,19,"eventData"],[21,30,21,9],[21,32,21,30],[22,0,22,4],[22,10,22,8,"validationErrors"],[22,26,22,24],[22,29,22,27,"validate"],[22,37,22,35],[22,38,22,36,"eventData"],[22,47,22,35],[22,49,22,47,"dataSpec"],[22,57,22,35],[22,59,22,57],[23,0,22,59,"format"],[23,8,22,59,"format"],[23,14,22,65],[23,16,22,67],[24,0,22,57],[24,7,22,35],[24,8,22,4],[26,0,23,4],[26,10,23,8],[26,17,23,16,"validationErrors"],[26,33,23,8],[26,38,23,38],[26,49,23,4],[26,51,23,51],[27,0,24,6],[27,14,24,12],[27,18,24,16,"errors"],[27,24,24,22],[27,25,24,23,"InvalidInputData"],[27,41,24,12],[27,42,24,40],[27,67,24,12],[27,69,24,67,"validationErrors"],[27,85,24,12],[27,86,24,6],[28,0,25,5],[30,0,27,4],[30,13,27,11],[30,18,27,16,"_sendEvent"],[30,28,27,11],[30,29,27,27,"resourceName"],[30,41,27,11],[30,43,27,41,"eventData"],[30,52,27,11],[30,53,27,4],[31,0,28,3],[31,5,21,2],[32,0,29,1],[32,3,19,0],[34,0,31,0,"StreamAnalytics"],[34,2,31,0,"StreamAnalytics"],[34,17,31,15],[34,18,31,16,"prototype"],[34,27,31,0],[34,28,31,26,"_sendEvent"],[34,38,31,0],[34,41,31,39],[34,51,31,49,"resourceName"],[34,63,31,39],[34,65,31,63,"eventData"],[34,74,31,39],[34,76,31,74],[35,0,32,2],[35,8,32,6],[35,13,32,11,"userData"],[35,21,32,6],[35,26,32,24],[35,30,32,2],[35,32,32,30],[36,0,33,4],[36,12,33,10],[36,16,33,14,"errors"],[36,22,33,20],[36,23,33,21,"MissingUserId"],[36,36,33,10],[36,37,33,35],[36,59,33,10],[36,60,33,4],[37,0,34,3],[39,0,36,2,"eventData"],[39,4,36,2,"eventData"],[39,13,36,11],[39,14,36,12],[39,25,36,11],[39,26,36,2],[39,29,36,27],[39,34,36,32,"userData"],[39,42,36,2],[40,0,37,2],[40,11,37,9],[40,16,37,14,"client"],[40,22,37,9],[40,23,37,21,"send"],[40,27,37,9],[40,28,37,26,"resourceName"],[40,40,37,9],[40,42,37,40,"eventData"],[40,51,37,9],[40,52,37,2],[41,0,38,1],[41,3,31,0],[43,0,40,0,"StreamAnalytics"],[43,2,40,0,"StreamAnalytics"],[43,17,40,15],[43,18,40,16,"prototype"],[43,27,40,0],[43,28,40,26,"trackImpression"],[43,43,40,0],[43,46,41,2,"StreamAnalytics"],[43,61,41,17],[43,62,41,18,"prototype"],[43,71,41,2],[43,72,41,28,"_sendEventFactory"],[43,89,41,2],[43,90,42,4],[43,102,41,2],[43,104,43,4,"specs"],[43,109,43,9],[43,110,43,10,"impressionSpec"],[43,124,41,2],[43,125,40,0],[44,0,45,0,"StreamAnalytics"],[44,2,45,0,"StreamAnalytics"],[44,17,45,15],[44,18,45,16,"prototype"],[44,27,45,0],[44,28,45,26,"trackEngagement"],[44,43,45,0],[44,46,46,2,"StreamAnalytics"],[44,61,46,17],[44,62,46,18,"prototype"],[44,71,46,2],[44,72,46,28,"_sendEventFactory"],[44,89,46,2],[44,90,47,4],[44,102,46,2],[44,104,48,4,"specs"],[44,109,48,9],[44,110,48,10,"engagementSpec"],[44,124,46,2],[44,125,45,0],[45,0,51,0,"StreamAnalytics"],[45,2,51,0,"StreamAnalytics"],[45,17,51,15],[45,18,51,16,"Client"],[45,24,51,0],[45,27,51,25,"Client"],[45,33,51,0],[46,0,52,0,"StreamAnalytics"],[46,2,52,0,"StreamAnalytics"],[46,17,52,15],[46,18,52,16,"errors"],[46,24,52,0],[46,27,52,25,"errors"],[46,33,52,0],[47,0,54,0],[47,6,54,4],[47,13,54,12,"window"],[47,19,54,4],[47,24,54,24],[47,35,54,0],[47,37,55,2,"require"],[47,48,55,9],[47,81,55,2],[47,82,55,24,"StreamAnalytics"],[47,97,55,2],[48,0,57,0,"module"],[48,2,57,0,"module"],[48,8,57,6],[48,9,57,7,"exports"],[48,16,57,0],[48,19,57,17,"StreamAnalytics"],[48,34,57,0]],"functionMap":{"names":["<global>","StreamAnalytics","StreamAnalytics.prototype.configure","StreamAnalytics.prototype.setUser","StreamAnalytics.prototype._sendEventFactory","<anonymous>","StreamAnalytics.prototype._sendEvent"],"mappings":"AAA;sBCK;CDE;sCEE;CFG;oCGE;CHE;8CIE;SCE;GDO;CJC;uCME;CNO"}},"type":"js/module"}]}