{"dependencies":[{"name":"@babel/runtime/helpers/extends","data":{"isAsync":false}},{"name":"@stream-io/cross-fetch","data":{"isAsync":false}},{"name":"form-data","data":{"isAsync":false}},{"name":"./utils","data":{"isAsync":false}},{"name":"./errors","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _extends = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/extends\");\n\n  var fetch = _$$_REQUIRE(_dependencyMap[1], \"@stream-io/cross-fetch\");\n\n  var Headers = _$$_REQUIRE(_dependencyMap[1], \"@stream-io/cross-fetch\").Headers;\n\n  var FormData = _$$_REQUIRE(_dependencyMap[2], \"form-data\");\n\n  var utils = _$$_REQUIRE(_dependencyMap[3], \"./utils\");\n\n  var errors = _$$_REQUIRE(_dependencyMap[4], \"./errors\");\n\n  var StreamImageStore = function StreamImageStore() {\n    this.initialize.apply(this, arguments);\n  };\n\n  StreamImageStore.prototype = {\n    initialize: function initialize(client, token) {\n      this.client = client;\n      this.token = token;\n    },\n    upload: function upload(uri, name, contentType) {\n      var data = new FormData();\n      var fileField;\n\n      if (utils.isReadableStream(uri)) {\n        fileField = uri;\n      } else {\n        fileField = {\n          uri: uri,\n          name: name || uri.split('/').reverse()[0]\n        };\n\n        if (contentType != null) {\n          fileField.type = contentType;\n        }\n      }\n\n      data.append('file', fileField);\n      return fetch(\"\".concat(this.client.enrichUrl('images/'), \"?api_key=\").concat(this.client.apiKey), {\n        method: 'post',\n        body: data,\n        headers: new Headers({\n          Authorization: this.token\n        })\n      }).then(function (r) {\n        if (r.ok) {\n          return r.json();\n        }\n\n        return r.text().then(function (responseData) {\n          r.statusCode = r.status;\n\n          try {\n            responseData = JSON.parse(responseData);\n          } catch (e) {}\n\n          throw new errors.StreamApiError(JSON.stringify(responseData) + ' with HTTP status code ' + r.status, responseData, r);\n        });\n      });\n    },\n    delete: function _delete(uri) {\n      return this.client.delete({\n        url: \"images/\",\n        qs: {\n          url: uri\n        },\n        signature: this.token\n      });\n    },\n    process: function process(uri, options) {\n      var params = _extends(options, {\n        url: uri\n      });\n\n      if (Array.isArray(params.crop)) {\n        params.crop = params.crop.join(',');\n      }\n\n      return this.client.get({\n        url: \"images/\",\n        qs: params,\n        signature: this.token\n      });\n    },\n    thumbmail: function thumbmail(uri, w, h) {\n      var _ref = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {\n        crop: 'center',\n        resize: 'clip'\n      },\n          crop = _ref.crop,\n          resize = _ref.resize;\n\n      return this.process(uri, {\n        w: w,\n        h: h,\n        crop: crop,\n        resize: resize\n      });\n    }\n  };\n  module.exports = StreamImageStore;\n});","lineCount":104,"map":[[2,0,1,0],[2,6,1,4,"_extends"],[2,14,1,12],[2,17,1,15,"require"],[2,28,1,22],[2,81,1,0],[4,0,3,0],[4,6,3,4,"fetch"],[4,11,3,9],[4,14,3,12,"require"],[4,25,3,19],[4,70,3,0],[6,0,5,0],[6,6,5,4,"Headers"],[6,13,5,11],[6,16,5,14,"require"],[6,27,5,21],[6,72,5,14],[6,73,5,48,"Headers"],[6,80,5,0],[8,0,7,0],[8,6,7,4,"FormData"],[8,14,7,12],[8,17,7,15,"require"],[8,28,7,22],[8,60,7,0],[10,0,9,0],[10,6,9,4,"utils"],[10,11,9,9],[10,14,9,12,"require"],[10,25,9,19],[10,55,9,0],[12,0,11,0],[12,6,11,4,"errors"],[12,12,11,10],[12,15,11,13,"require"],[12,26,11,20],[12,57,11,0],[14,0,13,0],[14,6,13,4,"StreamImageStore"],[14,22,13,20],[14,25,13,23],[14,34,13,32,"StreamImageStore"],[14,50,13,23],[14,53,13,51],[15,0,14,2],[15,9,14,7,"initialize"],[15,19,14,2],[15,20,14,18,"apply"],[15,25,14,2],[15,26,14,24],[15,30,14,2],[15,32,14,30,"arguments"],[15,41,14,2],[16,0,15,1],[16,3,13,0],[18,0,17,0,"StreamImageStore"],[18,2,17,0,"StreamImageStore"],[18,18,17,16],[18,19,17,17,"prototype"],[18,28,17,0],[18,31,17,29],[19,0,18,2,"initialize"],[19,4,18,2,"initialize"],[19,14,18,12],[19,16,18,14],[19,25,18,23,"initialize"],[19,35,18,14],[19,36,18,34,"client"],[19,42,18,14],[19,44,18,42,"token"],[19,49,18,14],[19,51,18,49],[20,0,19,4],[20,11,19,9,"client"],[20,17,19,4],[20,20,19,18,"client"],[20,26,19,4],[21,0,20,4],[21,11,20,9,"token"],[21,16,20,4],[21,19,20,17,"token"],[21,24,20,4],[22,0,21,3],[22,5,17,29],[23,0,24,2,"upload"],[23,4,24,2,"upload"],[23,10,24,8],[23,12,24,10],[23,21,24,19,"upload"],[23,27,24,10],[23,28,24,26,"uri"],[23,31,24,10],[23,33,24,31,"name"],[23,37,24,10],[23,39,24,37,"contentType"],[23,50,24,10],[23,52,24,50],[24,0,25,4],[24,10,25,8,"data"],[24,14,25,12],[24,17,25,15],[24,21,25,19,"FormData"],[24,29,25,15],[24,31,25,4],[25,0,26,4],[25,10,26,8,"fileField"],[25,19,26,4],[27,0,28,4],[27,10,28,8,"utils"],[27,15,28,13],[27,16,28,14,"isReadableStream"],[27,32,28,8],[27,33,28,31,"uri"],[27,36,28,8],[27,37,28,4],[27,39,28,37],[28,0,29,6,"fileField"],[28,8,29,6,"fileField"],[28,17,29,15],[28,20,29,18,"uri"],[28,23,29,6],[29,0,30,5],[29,7,28,4],[29,13,30,11],[30,0,31,6,"fileField"],[30,8,31,6,"fileField"],[30,17,31,15],[30,20,31,18],[31,0,32,8,"uri"],[31,10,32,8,"uri"],[31,13,32,11],[31,15,32,13,"uri"],[31,18,31,18],[32,0,33,8,"name"],[32,10,33,8,"name"],[32,14,33,12],[32,16,33,14,"name"],[32,20,33,18],[32,24,33,22,"uri"],[32,27,33,25],[32,28,33,26,"split"],[32,33,33,22],[32,34,33,32],[32,37,33,22],[32,39,33,37,"reverse"],[32,46,33,22],[32,49,33,47],[32,50,33,22],[33,0,31,18],[33,9,31,6],[35,0,36,6],[35,12,36,10,"contentType"],[35,23,36,21],[35,27,36,25],[35,31,36,6],[35,33,36,31],[36,0,37,8,"fileField"],[36,10,37,8,"fileField"],[36,19,37,17],[36,20,37,18,"type"],[36,24,37,8],[36,27,37,25,"contentType"],[36,38,37,8],[37,0,38,7],[38,0,39,5],[40,0,41,4,"data"],[40,6,41,4,"data"],[40,10,41,8],[40,11,41,9,"append"],[40,17,41,4],[40,18,41,16],[40,24,41,4],[40,26,41,24,"fileField"],[40,35,41,4],[41,0,42,4],[41,13,42,11,"fetch"],[41,18,42,16],[41,19,42,17],[41,22,42,20,"concat"],[41,28,42,17],[41,29,42,27],[41,34,42,32,"client"],[41,40,42,27],[41,41,42,39,"enrichUrl"],[41,50,42,27],[41,51,42,49],[41,60,42,27],[41,61,42,17],[41,63,42,61],[41,74,42,17],[41,76,42,74,"concat"],[41,82,42,17],[41,83,42,81],[41,88,42,86,"client"],[41,94,42,81],[41,95,42,93,"apiKey"],[41,101,42,17],[41,102,42,16],[41,104,42,102],[42,0,43,6,"method"],[42,8,43,6,"method"],[42,14,43,12],[42,16,43,14],[42,22,42,102],[43,0,44,6,"body"],[43,8,44,6,"body"],[43,12,44,10],[43,14,44,12,"data"],[43,18,42,102],[44,0,45,6,"headers"],[44,8,45,6,"headers"],[44,15,45,13],[44,17,45,15],[44,21,45,19,"Headers"],[44,28,45,15],[44,29,45,27],[45,0,46,8,"Authorization"],[45,10,46,8,"Authorization"],[45,23,46,21],[45,25,46,23],[45,30,46,28,"token"],[46,0,45,27],[46,9,45,15],[47,0,42,102],[47,7,42,16],[47,8,42,11],[47,9,48,7,"then"],[47,13,42,11],[47,14,48,12],[47,24,48,22,"r"],[47,25,48,12],[47,27,48,25],[48,0,49,6],[48,12,49,10,"r"],[48,13,49,11],[48,14,49,12,"ok"],[48,16,49,6],[48,18,49,16],[49,0,50,8],[49,17,50,15,"r"],[49,18,50,16],[49,19,50,17,"json"],[49,23,50,15],[49,25,50,8],[50,0,51,7],[52,0,54,6],[52,15,54,13,"r"],[52,16,54,14],[52,17,54,15,"text"],[52,21,54,13],[52,24,54,22,"then"],[52,28,54,13],[52,29,54,27],[52,39,54,37,"responseData"],[52,51,54,27],[52,53,54,51],[53,0,55,8,"r"],[53,10,55,8,"r"],[53,11,55,9],[53,12,55,10,"statusCode"],[53,22,55,8],[53,25,55,23,"r"],[53,26,55,24],[53,27,55,25,"status"],[53,33,55,8],[55,0,57,8],[55,14,57,12],[56,0,58,10,"responseData"],[56,12,58,10,"responseData"],[56,24,58,22],[56,27,58,25,"JSON"],[56,31,58,29],[56,32,58,30,"parse"],[56,37,58,25],[56,38,58,36,"responseData"],[56,50,58,25],[56,51,58,10],[57,0,59,9],[57,11,57,8],[57,12,59,10],[57,19,59,17,"e"],[57,20,59,10],[57,22,59,20],[57,23,60,9],[59,0,62,8],[59,16,62,14],[59,20,62,18,"errors"],[59,26,62,24],[59,27,62,25,"StreamApiError"],[59,41,62,14],[59,42,62,40,"JSON"],[59,46,62,44],[59,47,62,45,"stringify"],[59,56,62,40],[59,57,62,55,"responseData"],[59,69,62,40],[59,73,62,71],[59,98,62,40],[59,101,62,99,"r"],[59,102,62,100],[59,103,62,101,"status"],[59,109,62,14],[59,111,62,109,"responseData"],[59,123,62,14],[59,125,62,123,"r"],[59,126,62,14],[59,127,62,8],[60,0,63,7],[60,9,54,13],[60,10,54,6],[61,0,64,5],[61,7,42,11],[61,8,42,4],[62,0,65,3],[62,5,17,29],[63,0,66,2,"delete"],[63,4,66,2,"delete"],[63,10,66,8],[63,12,66,10],[63,21,66,19,"_delete"],[63,28,66,10],[63,29,66,27,"uri"],[63,32,66,10],[63,34,66,32],[64,0,67,4],[64,13,67,11],[64,18,67,16,"client"],[64,24,67,11],[64,25,67,23,"delete"],[64,31,67,11],[64,32,67,30],[65,0,68,6,"url"],[65,8,68,6,"url"],[65,11,68,9],[65,13,68,11],[65,22,67,30],[66,0,69,6,"qs"],[66,8,69,6,"qs"],[66,10,69,8],[66,12,69,10],[67,0,70,8,"url"],[67,10,70,8,"url"],[67,13,70,11],[67,15,70,13,"uri"],[68,0,69,10],[68,9,67,30],[69,0,72,6,"signature"],[69,8,72,6,"signature"],[69,17,72,15],[69,19,72,17],[69,24,72,22,"token"],[70,0,67,30],[70,7,67,11],[70,8,67,4],[71,0,74,3],[71,5,17,29],[72,0,75,2,"process"],[72,4,75,2,"process"],[72,11,75,9],[72,13,75,11],[72,22,75,20,"process"],[72,29,75,11],[72,30,75,28,"uri"],[72,33,75,11],[72,35,75,33,"options"],[72,42,75,11],[72,44,75,42],[73,0,76,4],[73,10,76,8,"params"],[73,16,76,14],[73,19,76,17,"_extends"],[73,27,76,25],[73,28,76,26,"options"],[73,35,76,25],[73,37,76,35],[74,0,77,6,"url"],[74,8,77,6,"url"],[74,11,77,9],[74,13,77,11,"uri"],[75,0,76,35],[75,7,76,25],[75,8,76,4],[77,0,80,4],[77,10,80,8,"Array"],[77,15,80,13],[77,16,80,14,"isArray"],[77,23,80,8],[77,24,80,22,"params"],[77,30,80,28],[77,31,80,29,"crop"],[77,35,80,8],[77,36,80,4],[77,38,80,36],[78,0,81,6,"params"],[78,8,81,6,"params"],[78,14,81,12],[78,15,81,13,"crop"],[78,19,81,6],[78,22,81,20,"params"],[78,28,81,26],[78,29,81,27,"crop"],[78,33,81,20],[78,34,81,32,"join"],[78,38,81,20],[78,39,81,37],[78,42,81,20],[78,43,81,6],[79,0,82,5],[81,0,84,4],[81,13,84,11],[81,18,84,16,"client"],[81,24,84,11],[81,25,84,23,"get"],[81,28,84,11],[81,29,84,27],[82,0,85,6,"url"],[82,8,85,6,"url"],[82,11,85,9],[82,13,85,11],[82,22,84,27],[83,0,86,6,"qs"],[83,8,86,6,"qs"],[83,10,86,8],[83,12,86,10,"params"],[83,18,84,27],[84,0,87,6,"signature"],[84,8,87,6,"signature"],[84,17,87,15],[84,19,87,17],[84,24,87,22,"token"],[85,0,84,27],[85,7,84,11],[85,8,84,4],[86,0,89,3],[86,5,17,29],[87,0,90,2,"thumbmail"],[87,4,90,2,"thumbmail"],[87,13,90,11],[87,15,90,13],[87,24,90,22,"thumbmail"],[87,33,90,13],[87,34,90,32,"uri"],[87,37,90,13],[87,39,90,37,"w"],[87,40,90,13],[87,42,90,40,"h"],[87,43,90,13],[87,45,90,43],[88,0,91,4],[88,10,91,8,"_ref"],[88,14,91,12],[88,17,91,15,"arguments"],[88,26,91,24],[88,27,91,25,"length"],[88,33,91,15],[88,36,91,34],[88,37,91,15],[88,41,91,39,"arguments"],[88,50,91,48],[88,51,91,49],[88,52,91,48],[88,53,91,39],[88,58,91,56,"undefined"],[88,67,91,15],[88,70,91,68,"arguments"],[88,79,91,77],[88,80,91,78],[88,81,91,77],[88,82,91,15],[88,85,91,83],[89,0,92,6,"crop"],[89,8,92,6,"crop"],[89,12,92,10],[89,14,92,12],[89,22,91,83],[90,0,93,6,"resize"],[90,8,93,6,"resize"],[90,14,93,12],[90,16,93,14],[91,0,91,83],[91,7,91,4],[92,0,91,4],[92,10,95,8,"crop"],[92,14,95,12],[92,17,95,15,"_ref"],[92,21,95,19],[92,22,95,20,"crop"],[92,26,91,4],[93,0,91,4],[93,10,96,8,"resize"],[93,16,96,14],[93,19,96,17,"_ref"],[93,23,96,21],[93,24,96,22,"resize"],[93,30,91,4],[95,0,98,4],[95,13,98,11],[95,18,98,16,"process"],[95,25,98,11],[95,26,98,24,"uri"],[95,29,98,11],[95,31,98,29],[96,0,99,6,"w"],[96,8,99,6,"w"],[96,9,99,7],[96,11,99,9,"w"],[96,12,98,29],[97,0,100,6,"h"],[97,8,100,6,"h"],[97,9,100,7],[97,11,100,9,"h"],[97,12,98,29],[98,0,101,6,"crop"],[98,8,101,6,"crop"],[98,12,101,10],[98,14,101,12,"crop"],[98,18,98,29],[99,0,102,6,"resize"],[99,8,102,6,"resize"],[99,14,102,12],[99,16,102,14,"resize"],[100,0,98,29],[100,7,98,11],[100,8,98,4],[101,0,104,3],[102,0,17,29],[102,3,17,0],[103,0,106,0,"module"],[103,2,106,0,"module"],[103,8,106,6],[103,9,106,7,"exports"],[103,16,106,0],[103,19,106,17,"StreamImageStore"],[103,35,106,0]],"functionMap":{"names":["<global>","StreamImageStore","initialize","upload","fetch.then$argument_0","r.text.then$argument_0","_delete","process","thumbmail"],"mappings":"AAA;uBCY;CDE;cEG;GFG;UGG;YCwB;2BCM;ODS;KDC;GHC;UMC;GNQ;WOC;GPc;aQC;GRc"}},"type":"js/module"}]}