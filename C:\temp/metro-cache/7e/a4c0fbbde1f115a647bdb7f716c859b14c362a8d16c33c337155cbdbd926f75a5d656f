{"dependencies":[{"name":"@stream-io/cross-fetch","data":{"isAsync":false}},{"name":"./utils","data":{"isAsync":false}},{"name":"form-data","data":{"isAsync":false}},{"name":"./errors","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var fetch = _$$_REQUIRE(_dependencyMap[0], \"@stream-io/cross-fetch\");\n\n  var Headers = _$$_REQUIRE(_dependencyMap[0], \"@stream-io/cross-fetch\").Headers;\n\n  var utils = _$$_REQUIRE(_dependencyMap[1], \"./utils\");\n\n  var FormData = _$$_REQUIRE(_dependencyMap[2], \"form-data\");\n\n  var errors = _$$_REQUIRE(_dependencyMap[3], \"./errors\");\n\n  var StreamFileStore = function StreamFileStore() {\n    this.initialize.apply(this, arguments);\n  };\n\n  StreamFileStore.prototype = {\n    initialize: function initialize(client, token) {\n      this.client = client;\n      this.token = token;\n    },\n    upload: function upload(uri, name, contentType) {\n      var data = new FormData();\n      var fileField;\n\n      if (utils.isReadableStream(uri)) {\n        fileField = uri;\n      } else {\n        fileField = {\n          uri: uri,\n          name: name || uri.split('/').reverse()[0]\n        };\n\n        if (contentType != null) {\n          fileField.type = contentType;\n        }\n      }\n\n      data.append('file', fileField);\n      return fetch(\"\".concat(this.client.enrichUrl('files/'), \"?api_key=\").concat(this.client.apiKey), {\n        method: 'post',\n        body: data,\n        headers: new Headers({\n          Authorization: this.token\n        })\n      }).then(function (r) {\n        if (r.ok) {\n          return r.json();\n        }\n\n        return r.text().then(function (responseData) {\n          r.statusCode = r.status;\n\n          try {\n            responseData = JSON.parse(responseData);\n          } catch (e) {}\n\n          throw new errors.StreamApiError(JSON.stringify(responseData) + ' with HTTP status code ' + r.status, responseData, r);\n        });\n      });\n    },\n    delete: function _delete(uri) {\n      return this.client.delete({\n        url: \"files/\",\n        qs: {\n          url: uri\n        },\n        signature: this.token\n      });\n    }\n  };\n  module.exports = StreamFileStore;\n});","lineCount":72,"map":[[2,0,1,0],[2,6,1,4,"fetch"],[2,11,1,9],[2,14,1,12,"require"],[2,25,1,19],[2,70,1,0],[4,0,3,0],[4,6,3,4,"Headers"],[4,13,3,11],[4,16,3,14,"require"],[4,27,3,21],[4,72,3,14],[4,73,3,48,"Headers"],[4,80,3,0],[6,0,5,0],[6,6,5,4,"utils"],[6,11,5,9],[6,14,5,12,"require"],[6,25,5,19],[6,55,5,0],[8,0,7,0],[8,6,7,4,"FormData"],[8,14,7,12],[8,17,7,15,"require"],[8,28,7,22],[8,60,7,0],[10,0,9,0],[10,6,9,4,"errors"],[10,12,9,10],[10,15,9,13,"require"],[10,26,9,20],[10,57,9,0],[12,0,11,0],[12,6,11,4,"StreamFileStore"],[12,21,11,19],[12,24,11,22],[12,33,11,31,"StreamFileStore"],[12,48,11,22],[12,51,11,49],[13,0,12,2],[13,9,12,7,"initialize"],[13,19,12,2],[13,20,12,18,"apply"],[13,25,12,2],[13,26,12,24],[13,30,12,2],[13,32,12,30,"arguments"],[13,41,12,2],[14,0,13,1],[14,3,11,0],[16,0,15,0,"StreamFileStore"],[16,2,15,0,"StreamFileStore"],[16,17,15,15],[16,18,15,16,"prototype"],[16,27,15,0],[16,30,15,28],[17,0,16,2,"initialize"],[17,4,16,2,"initialize"],[17,14,16,12],[17,16,16,14],[17,25,16,23,"initialize"],[17,35,16,14],[17,36,16,34,"client"],[17,42,16,14],[17,44,16,42,"token"],[17,49,16,14],[17,51,16,49],[18,0,17,4],[18,11,17,9,"client"],[18,17,17,4],[18,20,17,18,"client"],[18,26,17,4],[19,0,18,4],[19,11,18,9,"token"],[19,16,18,4],[19,19,18,17,"token"],[19,24,18,4],[20,0,19,3],[20,5,15,28],[21,0,22,2,"upload"],[21,4,22,2,"upload"],[21,10,22,8],[21,12,22,10],[21,21,22,19,"upload"],[21,27,22,10],[21,28,22,26,"uri"],[21,31,22,10],[21,33,22,31,"name"],[21,37,22,10],[21,39,22,37,"contentType"],[21,50,22,10],[21,52,22,50],[22,0,23,4],[22,10,23,8,"data"],[22,14,23,12],[22,17,23,15],[22,21,23,19,"FormData"],[22,29,23,15],[22,31,23,4],[23,0,24,4],[23,10,24,8,"fileField"],[23,19,24,4],[25,0,26,4],[25,10,26,8,"utils"],[25,15,26,13],[25,16,26,14,"isReadableStream"],[25,32,26,8],[25,33,26,31,"uri"],[25,36,26,8],[25,37,26,4],[25,39,26,37],[26,0,27,6,"fileField"],[26,8,27,6,"fileField"],[26,17,27,15],[26,20,27,18,"uri"],[26,23,27,6],[27,0,28,5],[27,7,26,4],[27,13,28,11],[28,0,29,6,"fileField"],[28,8,29,6,"fileField"],[28,17,29,15],[28,20,29,18],[29,0,30,8,"uri"],[29,10,30,8,"uri"],[29,13,30,11],[29,15,30,13,"uri"],[29,18,29,18],[30,0,31,8,"name"],[30,10,31,8,"name"],[30,14,31,12],[30,16,31,14,"name"],[30,20,31,18],[30,24,31,22,"uri"],[30,27,31,25],[30,28,31,26,"split"],[30,33,31,22],[30,34,31,32],[30,37,31,22],[30,39,31,37,"reverse"],[30,46,31,22],[30,49,31,47],[30,50,31,22],[31,0,29,18],[31,9,29,6],[33,0,34,6],[33,12,34,10,"contentType"],[33,23,34,21],[33,27,34,25],[33,31,34,6],[33,33,34,31],[34,0,35,8,"fileField"],[34,10,35,8,"fileField"],[34,19,35,17],[34,20,35,18,"type"],[34,24,35,8],[34,27,35,25,"contentType"],[34,38,35,8],[35,0,36,7],[36,0,37,5],[38,0,39,4,"data"],[38,6,39,4,"data"],[38,10,39,8],[38,11,39,9,"append"],[38,17,39,4],[38,18,39,16],[38,24,39,4],[38,26,39,24,"fileField"],[38,35,39,4],[39,0,40,4],[39,13,40,11,"fetch"],[39,18,40,16],[39,19,40,17],[39,22,40,20,"concat"],[39,28,40,17],[39,29,40,27],[39,34,40,32,"client"],[39,40,40,27],[39,41,40,39,"enrichUrl"],[39,50,40,27],[39,51,40,49],[39,59,40,27],[39,60,40,17],[39,62,40,60],[39,73,40,17],[39,75,40,73,"concat"],[39,81,40,17],[39,82,40,80],[39,87,40,85,"client"],[39,93,40,80],[39,94,40,92,"apiKey"],[39,100,40,17],[39,101,40,16],[39,103,40,101],[40,0,41,6,"method"],[40,8,41,6,"method"],[40,14,41,12],[40,16,41,14],[40,22,40,101],[41,0,42,6,"body"],[41,8,42,6,"body"],[41,12,42,10],[41,14,42,12,"data"],[41,18,40,101],[42,0,43,6,"headers"],[42,8,43,6,"headers"],[42,15,43,13],[42,17,43,15],[42,21,43,19,"Headers"],[42,28,43,15],[42,29,43,27],[43,0,44,8,"Authorization"],[43,10,44,8,"Authorization"],[43,23,44,21],[43,25,44,23],[43,30,44,28,"token"],[44,0,43,27],[44,9,43,15],[45,0,40,101],[45,7,40,16],[45,8,40,11],[45,9,46,7,"then"],[45,13,40,11],[45,14,46,12],[45,24,46,22,"r"],[45,25,46,12],[45,27,46,25],[46,0,47,6],[46,12,47,10,"r"],[46,13,47,11],[46,14,47,12,"ok"],[46,16,47,6],[46,18,47,16],[47,0,48,8],[47,17,48,15,"r"],[47,18,48,16],[47,19,48,17,"json"],[47,23,48,15],[47,25,48,8],[48,0,49,7],[50,0,52,6],[50,15,52,13,"r"],[50,16,52,14],[50,17,52,15,"text"],[50,21,52,13],[50,24,52,22,"then"],[50,28,52,13],[50,29,52,27],[50,39,52,37,"responseData"],[50,51,52,27],[50,53,52,51],[51,0,53,8,"r"],[51,10,53,8,"r"],[51,11,53,9],[51,12,53,10,"statusCode"],[51,22,53,8],[51,25,53,23,"r"],[51,26,53,24],[51,27,53,25,"status"],[51,33,53,8],[53,0,55,8],[53,14,55,12],[54,0,56,10,"responseData"],[54,12,56,10,"responseData"],[54,24,56,22],[54,27,56,25,"JSON"],[54,31,56,29],[54,32,56,30,"parse"],[54,37,56,25],[54,38,56,36,"responseData"],[54,50,56,25],[54,51,56,10],[55,0,57,9],[55,11,55,8],[55,12,57,10],[55,19,57,17,"e"],[55,20,57,10],[55,22,57,20],[55,23,58,9],[57,0,60,8],[57,16,60,14],[57,20,60,18,"errors"],[57,26,60,24],[57,27,60,25,"StreamApiError"],[57,41,60,14],[57,42,60,40,"JSON"],[57,46,60,44],[57,47,60,45,"stringify"],[57,56,60,40],[57,57,60,55,"responseData"],[57,69,60,40],[57,73,60,71],[57,98,60,40],[57,101,60,99,"r"],[57,102,60,100],[57,103,60,101,"status"],[57,109,60,14],[57,111,60,109,"responseData"],[57,123,60,14],[57,125,60,123,"r"],[57,126,60,14],[57,127,60,8],[58,0,61,7],[58,9,52,13],[58,10,52,6],[59,0,62,5],[59,7,40,11],[59,8,40,4],[60,0,63,3],[60,5,15,28],[61,0,64,2,"delete"],[61,4,64,2,"delete"],[61,10,64,8],[61,12,64,10],[61,21,64,19,"_delete"],[61,28,64,10],[61,29,64,27,"uri"],[61,32,64,10],[61,34,64,32],[62,0,65,4],[62,13,65,11],[62,18,65,16,"client"],[62,24,65,11],[62,25,65,23,"delete"],[62,31,65,11],[62,32,65,30],[63,0,66,6,"url"],[63,8,66,6,"url"],[63,11,66,9],[63,13,66,11],[63,21,65,30],[64,0,67,6,"qs"],[64,8,67,6,"qs"],[64,10,67,8],[64,12,67,10],[65,0,68,8,"url"],[65,10,68,8,"url"],[65,13,68,11],[65,15,68,13,"uri"],[66,0,67,10],[66,9,65,30],[67,0,70,6,"signature"],[67,8,70,6,"signature"],[67,17,70,15],[67,19,70,17],[67,24,70,22,"token"],[68,0,65,30],[68,7,65,11],[68,8,65,4],[69,0,72,3],[70,0,15,28],[70,3,15,0],[71,0,74,0,"module"],[71,2,74,0,"module"],[71,8,74,6],[71,9,74,7,"exports"],[71,16,74,0],[71,19,74,17,"StreamFileStore"],[71,34,74,0]],"functionMap":{"names":["<global>","StreamFileStore","initialize","upload","fetch.then$argument_0","r.text.then$argument_0","_delete"],"mappings":"AAA;sBCU;CDE;cEG;GFG;UGG;YCwB;2BCM;ODS;KDC;GHC;UMC;GNQ"}},"type":"js/module"}]}