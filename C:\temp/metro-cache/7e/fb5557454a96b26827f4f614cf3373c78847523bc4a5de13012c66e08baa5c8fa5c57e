{"dependencies":[{"name":"@babel/runtime/helpers/extends","data":{"isAsync":false}},{"name":"@babel/runtime/helpers/objectSpread","data":{"isAsync":false}},{"name":"@babel/runtime/helpers/typeof","data":{"isAsync":false}},{"name":"jsonwebtoken","data":{"isAsync":false}},{"name":"Base64","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _extends = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/extends\");\n\n  var _objectSpread = _$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/helpers/objectSpread\");\n\n  var _typeof = _$$_REQUIRE(_dependencyMap[2], \"@babel/runtime/helpers/typeof\");\n\n  var jwt = _$$_REQUIRE(_dependencyMap[3], \"jsonwebtoken\");\n\n  var JWS_REGEX = /^[a-zA-Z0-9\\-_]+?\\.[a-zA-Z0-9\\-_]+?\\.([a-zA-Z0-9\\-_]+)?$/;\n\n  var Base64 = _$$_REQUIRE(_dependencyMap[4], \"Base64\");\n\n  function decodeBase64Url(base64UrlString) {\n    try {\n      return Base64.atob(toBase64(base64UrlString));\n    } catch (e) {\n      if (e.name === 'InvalidCharacterError') {\n        return undefined;\n      } else {\n        throw e;\n      }\n    }\n  }\n\n  function safeJsonParse(thing) {\n    if (_typeof(thing) === 'object') return thing;\n\n    try {\n      return JSON.parse(thing);\n    } catch (e) {\n      return undefined;\n    }\n  }\n\n  function padString(string) {\n    var segmentLength = 4;\n    var diff = string.length % segmentLength;\n    if (!diff) return string;\n    var padLength = segmentLength - diff;\n\n    while (padLength--) {\n      string += '=';\n    }\n\n    return string;\n  }\n\n  function toBase64(base64UrlString) {\n    var b64str = padString(base64UrlString).replace(/\\-/g, '+').replace(/_/g, '/');\n    return b64str;\n  }\n\n  function headerFromJWS(jwsSig) {\n    var encodedHeader = jwsSig.split('.', 1)[0];\n    return safeJsonParse(decodeBase64Url(encodedHeader));\n  }\n\n  exports.headerFromJWS = headerFromJWS;\n\n  exports.JWTScopeToken = function (apiSecret, resource, action, opts) {\n    var options = opts || {},\n        noTimestamp = options.expireTokens ? !options.expireTokens : true;\n    var payload = {\n      resource: resource,\n      action: action\n    };\n\n    if (options.feedId) {\n      payload['feed_id'] = options.feedId;\n    }\n\n    if (options.userId) {\n      payload['user_id'] = options.userId;\n    }\n\n    var token = jwt.sign(payload, apiSecret, {\n      algorithm: 'HS256',\n      noTimestamp: noTimestamp\n    });\n    return token;\n  };\n\n  exports.JWTUserSessionToken = function (apiSecret, userId) {\n    var extraData = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var jwtOptions = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n    if (typeof userId !== 'string') {\n      throw new TypeError('userId should be a string');\n    }\n\n    var payload = _objectSpread({\n      user_id: userId\n    }, extraData);\n\n    var opts = _extends({\n      algorithm: 'HS256',\n      noTimestamp: true\n    }, jwtOptions);\n\n    var token = jwt.sign(payload, apiSecret, opts);\n    return token;\n  };\n\n  exports.isJWTSignature = exports.isJWT = function (signature) {\n    if (signature == null || signature.length == 0) {\n      return false;\n    }\n\n    var token = signature.split(' ')[1] || signature;\n    return JWS_REGEX.test(token) && !!headerFromJWS(token);\n  };\n});","lineCount":113,"map":[[2,0,1,0],[2,6,1,4,"_extends"],[2,14,1,12],[2,17,1,15,"require"],[2,28,1,22],[2,81,1,0],[4,0,3,0],[4,6,3,4,"_objectSpread"],[4,19,3,17],[4,22,3,20,"require"],[4,33,3,27],[4,91,3,0],[6,0,5,0],[6,6,5,4,"_typeof"],[6,13,5,11],[6,16,5,14,"require"],[6,27,5,21],[6,79,5,0],[8,0,7,0],[8,6,7,4,"jwt"],[8,9,7,7],[8,12,7,10,"require"],[8,23,7,17],[8,58,7,0],[10,0,9,0],[10,6,9,4,"JWS_REGEX"],[10,15,9,13],[10,18,9,16],[10,76,9,0],[12,0,11,0],[12,6,11,4,"Base64"],[12,12,11,10],[12,15,11,13,"require"],[12,26,11,20],[12,55,11,0],[14,0,13,0],[14,11,13,9,"decodeBase64Url"],[14,26,13,0],[14,27,13,25,"base64UrlString"],[14,42,13,0],[14,44,13,42],[15,0,14,2],[15,8,14,6],[16,0,15,4],[16,13,15,11,"Base64"],[16,19,15,17],[16,20,15,18,"atob"],[16,24,15,11],[16,25,15,23,"toBase64"],[16,33,15,31],[16,34,15,32,"base64UrlString"],[16,49,15,31],[16,50,15,11],[16,51,15,4],[17,0,16,3],[17,5,14,2],[17,6,16,4],[17,13,16,11,"e"],[17,14,16,4],[17,16,16,14],[18,0,18,4],[18,10,18,8,"e"],[18,11,18,9],[18,12,18,10,"name"],[18,16,18,8],[18,21,18,19],[18,44,18,4],[18,46,18,44],[19,0,19,6],[19,15,19,13,"undefined"],[19,24,19,6],[20,0,20,5],[20,7,18,4],[20,13,20,11],[21,0,21,6],[21,14,21,12,"e"],[21,15,21,6],[22,0,22,5],[23,0,23,3],[24,0,24,1],[26,0,26,0],[26,11,26,9,"safeJsonParse"],[26,24,26,0],[26,25,26,23,"thing"],[26,30,26,0],[26,32,26,30],[27,0,27,2],[27,8,27,6,"_typeof"],[27,15,27,13],[27,16,27,14,"thing"],[27,21,27,13],[27,22,27,6],[27,27,27,25],[27,35,27,2],[27,37,27,35],[27,44,27,42,"thing"],[27,49,27,35],[29,0,29,2],[29,8,29,6],[30,0,30,4],[30,13,30,11,"JSON"],[30,17,30,15],[30,18,30,16,"parse"],[30,23,30,11],[30,24,30,22,"thing"],[30,29,30,11],[30,30,30,4],[31,0,31,3],[31,5,29,2],[31,6,31,4],[31,13,31,11,"e"],[31,14,31,4],[31,16,31,14],[32,0,32,4],[32,13,32,11,"undefined"],[32,22,32,4],[33,0,33,3],[34,0,34,1],[36,0,36,0],[36,11,36,9,"padString"],[36,20,36,0],[36,21,36,19,"string"],[36,27,36,0],[36,29,36,27],[37,0,37,2],[37,8,37,6,"segmentLength"],[37,21,37,19],[37,24,37,22],[37,25,37,2],[38,0,38,2],[38,8,38,6,"diff"],[38,12,38,10],[38,15,38,13,"string"],[38,21,38,19],[38,22,38,20,"length"],[38,28,38,13],[38,31,38,29,"segmentLength"],[38,44,38,2],[39,0,39,2],[39,8,39,6],[39,9,39,7,"diff"],[39,13,39,2],[39,15,39,13],[39,22,39,20,"string"],[39,28,39,13],[40,0,40,2],[40,8,40,6,"padLength"],[40,17,40,15],[40,20,40,18,"segmentLength"],[40,33,40,31],[40,36,40,34,"diff"],[40,40,40,2],[42,0,42,2],[42,11,42,9,"padLength"],[42,20,42,18],[42,22,42,2],[42,24,42,22],[43,0,43,4,"string"],[43,6,43,4,"string"],[43,12,43,10],[43,16,43,14],[43,19,43,4],[44,0,44,3],[46,0,46,2],[46,11,46,9,"string"],[46,17,46,2],[47,0,47,1],[49,0,49,0],[49,11,49,9,"toBase64"],[49,19,49,0],[49,20,49,18,"base64UrlString"],[49,35,49,0],[49,37,49,35],[50,0,50,2],[50,8,50,6,"b64str"],[50,14,50,12],[50,17,50,15,"padString"],[50,26,50,24],[50,27,50,25,"base64UrlString"],[50,42,50,24],[50,43,50,15],[50,44,50,42,"replace"],[50,51,50,15],[50,52,50,50],[50,57,50,15],[50,59,50,57],[50,62,50,15],[50,64,51,3,"replace"],[50,71,50,15],[50,72,51,11],[50,76,50,15],[50,78,51,17],[50,81,50,15],[50,82,50,2],[51,0,52,2],[51,11,52,9,"b64str"],[51,17,52,2],[52,0,53,1],[54,0,55,0],[54,11,55,9,"headerFromJWS"],[54,24,55,0],[54,25,55,23,"jwsSig"],[54,31,55,0],[54,33,55,31],[55,0,56,2],[55,8,56,6,"encodedHeader"],[55,21,56,19],[55,24,56,22,"jwsSig"],[55,30,56,28],[55,31,56,29,"split"],[55,36,56,22],[55,37,56,35],[55,40,56,22],[55,42,56,40],[55,43,56,22],[55,45,56,43],[55,46,56,22],[55,47,56,2],[56,0,57,2],[56,11,57,9,"safeJsonParse"],[56,24,57,22],[56,25,57,23,"decodeBase64Url"],[56,40,57,38],[56,41,57,39,"encodedHeader"],[56,54,57,38],[56,55,57,22],[56,56,57,2],[57,0,58,1],[59,0,60,0,"exports"],[59,2,60,0,"exports"],[59,9,60,7],[59,10,60,8,"headerFromJWS"],[59,23,60,0],[59,26,60,24,"headerFromJWS"],[59,39,60,0],[61,0,62,0,"exports"],[61,2,62,0,"exports"],[61,9,62,7],[61,10,62,8,"JWTScopeToken"],[61,23,62,0],[61,26,62,24],[61,36,62,34,"apiSecret"],[61,45,62,24],[61,47,62,45,"resource"],[61,55,62,24],[61,57,62,55,"action"],[61,63,62,24],[61,65,62,63,"opts"],[61,69,62,24],[61,71,62,69],[62,0,76,2],[62,8,76,6,"options"],[62,15,76,13],[62,18,76,16,"opts"],[62,22,76,20],[62,26,76,24],[62,28,76,2],[63,0,76,2],[63,8,77,6,"noTimestamp"],[63,19,77,17],[63,22,77,20,"options"],[63,29,77,27],[63,30,77,28,"expireTokens"],[63,42,77,20],[63,45,77,43],[63,46,77,44,"options"],[63,53,77,51],[63,54,77,52,"expireTokens"],[63,66,77,20],[63,69,77,67],[63,73,76,2],[64,0,78,2],[64,8,78,6,"payload"],[64,15,78,13],[64,18,78,16],[65,0,79,4,"resource"],[65,6,79,4,"resource"],[65,14,79,12],[65,16,79,14,"resource"],[65,24,78,16],[66,0,80,4,"action"],[66,6,80,4,"action"],[66,12,80,10],[66,14,80,12,"action"],[67,0,78,16],[67,5,78,2],[69,0,83,2],[69,8,83,6,"options"],[69,15,83,13],[69,16,83,14,"feedId"],[69,22,83,2],[69,24,83,22],[70,0,84,4,"payload"],[70,6,84,4,"payload"],[70,13,84,11],[70,14,84,12],[70,23,84,11],[70,24,84,4],[70,27,84,25,"options"],[70,34,84,32],[70,35,84,33,"feedId"],[70,41,84,4],[71,0,85,3],[73,0,87,2],[73,8,87,6,"options"],[73,15,87,13],[73,16,87,14,"userId"],[73,22,87,2],[73,24,87,22],[74,0,88,4,"payload"],[74,6,88,4,"payload"],[74,13,88,11],[74,14,88,12],[74,23,88,11],[74,24,88,4],[74,27,88,25,"options"],[74,34,88,32],[74,35,88,33,"userId"],[74,41,88,4],[75,0,89,3],[77,0,91,2],[77,8,91,6,"token"],[77,13,91,11],[77,16,91,14,"jwt"],[77,19,91,17],[77,20,91,18,"sign"],[77,24,91,14],[77,25,91,23,"payload"],[77,32,91,14],[77,34,91,32,"apiSecret"],[77,43,91,14],[77,45,91,43],[78,0,92,4,"algorithm"],[78,6,92,4,"algorithm"],[78,15,92,13],[78,17,92,15],[78,24,91,43],[79,0,93,4,"noTimestamp"],[79,6,93,4,"noTimestamp"],[79,17,93,15],[79,19,93,17,"noTimestamp"],[80,0,91,43],[80,5,91,14],[80,6,91,2],[81,0,95,2],[81,11,95,9,"token"],[81,16,95,2],[82,0,96,1],[82,3,62,0],[84,0,98,0,"exports"],[84,2,98,0,"exports"],[84,9,98,7],[84,10,98,8,"JWTUserSessionToken"],[84,29,98,0],[84,32,98,30],[84,42,98,40,"apiSecret"],[84,51,98,30],[84,53,98,51,"userId"],[84,59,98,30],[84,61,98,59],[85,0,99,2],[85,8,99,6,"extraData"],[85,17,99,15],[85,20,99,18,"arguments"],[85,29,99,27],[85,30,99,28,"length"],[85,36,99,18],[85,39,99,37],[85,40,99,18],[85,44,99,42,"arguments"],[85,53,99,51],[85,54,99,52],[85,55,99,51],[85,56,99,42],[85,61,99,59,"undefined"],[85,70,99,18],[85,73,99,71,"arguments"],[85,82,99,80],[85,83,99,81],[85,84,99,80],[85,85,99,18],[85,88,99,86],[85,90,99,2],[86,0,100,2],[86,8,100,6,"jwtOptions"],[86,18,100,16],[86,21,100,19,"arguments"],[86,30,100,28],[86,31,100,29,"length"],[86,37,100,19],[86,40,100,38],[86,41,100,19],[86,45,100,43,"arguments"],[86,54,100,52],[86,55,100,53],[86,56,100,52],[86,57,100,43],[86,62,100,60,"undefined"],[86,71,100,19],[86,74,100,72,"arguments"],[86,83,100,81],[86,84,100,82],[86,85,100,81],[86,86,100,19],[86,89,100,87],[86,91,100,2],[88,0,113,2],[88,8,113,6],[88,15,113,13,"userId"],[88,21,113,6],[88,26,113,24],[88,34,113,2],[88,36,113,34],[89,0,114,4],[89,12,114,10],[89,16,114,14,"TypeError"],[89,25,114,10],[89,26,114,24],[89,53,114,10],[89,54,114,4],[90,0,115,3],[92,0,117,2],[92,8,117,6,"payload"],[92,15,117,13],[92,18,117,16,"_objectSpread"],[92,31,117,29],[92,32,117,30],[93,0,118,4,"user_id"],[93,6,118,4,"user_id"],[93,13,118,11],[93,15,118,13,"userId"],[94,0,117,30],[94,5,117,29],[94,7,119,5,"extraData"],[94,16,117,29],[94,17,117,2],[96,0,121,2],[96,8,121,6,"opts"],[96,12,121,10],[96,15,121,13,"_extends"],[96,23,121,21],[96,24,121,22],[97,0,122,4,"algorithm"],[97,6,122,4,"algorithm"],[97,15,122,13],[97,17,122,15],[97,24,121,22],[98,0,123,4,"noTimestamp"],[98,6,123,4,"noTimestamp"],[98,17,123,15],[98,19,123,17],[99,0,121,22],[99,5,121,21],[99,7,124,5,"jwtOptions"],[99,17,121,21],[99,18,121,2],[101,0,126,2],[101,8,126,6,"token"],[101,13,126,11],[101,16,126,14,"jwt"],[101,19,126,17],[101,20,126,18,"sign"],[101,24,126,14],[101,25,126,23,"payload"],[101,32,126,14],[101,34,126,32,"apiSecret"],[101,43,126,14],[101,45,126,43,"opts"],[101,49,126,14],[101,50,126,2],[102,0,127,2],[102,11,127,9,"token"],[102,16,127,2],[103,0,128,1],[103,3,98,0],[105,0,130,0,"exports"],[105,2,130,0,"exports"],[105,9,130,7],[105,10,130,8,"isJWTSignature"],[105,24,130,0],[105,27,130,25,"exports"],[105,34,130,32],[105,35,130,33,"isJWT"],[105,40,130,25],[105,43,130,41],[105,53,130,51,"signature"],[105,62,130,41],[105,64,130,62],[106,0,139,2],[106,8,139,6,"signature"],[106,17,139,15],[106,21,139,19],[106,25,139,6],[106,29,139,27,"signature"],[106,38,139,36],[106,39,139,37,"length"],[106,45,139,27],[106,49,139,47],[106,50,139,2],[106,52,139,50],[107,0,140,4],[107,13,140,11],[107,18,140,4],[108,0,141,3],[110,0,143,2],[110,8,143,6,"token"],[110,13,143,11],[110,16,143,14,"signature"],[110,25,143,23],[110,26,143,24,"split"],[110,31,143,14],[110,32,143,30],[110,35,143,14],[110,37,143,35],[110,38,143,14],[110,43,143,41,"signature"],[110,52,143,2],[111,0,144,2],[111,11,144,9,"JWS_REGEX"],[111,20,144,18],[111,21,144,19,"test"],[111,25,144,9],[111,26,144,24,"token"],[111,31,144,9],[111,36,144,34],[111,37,144,35],[111,38,144,36,"headerFromJWS"],[111,51,144,49],[111,52,144,50,"token"],[111,57,144,49],[111,58,144,2],[112,0,145,1],[112,3,130,0]],"functionMap":{"names":["<global>","decodeBase64Url","safeJsonParse","padString","toBase64","headerFromJWS","exports.JWTScopeToken","exports.JWTUserSessionToken","exports.isJWT"],"mappings":"AAA;ACY;CDW;AEE;CFQ;AGE;CHW;AIE;CJI;AKE;CLG;wBMI;CNkC;8BOE;CP8B;yCQE;CRe"}},"type":"js/module"}]}