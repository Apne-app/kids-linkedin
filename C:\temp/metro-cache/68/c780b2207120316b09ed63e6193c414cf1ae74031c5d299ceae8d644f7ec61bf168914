{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"isAsync":false}},{"name":"@babel/runtime/helpers/slicedToArray","data":{"isAsync":false}},{"name":"@babel/runtime/helpers/typeof","data":{"isAsync":false}},{"name":"form-data","data":{"isAsync":false}},{"name":"./errors","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = void 0;\n\n  var _slicedToArray2 = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/helpers/slicedToArray\"));\n\n  var _typeof2 = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[2], \"@babel/runtime/helpers/typeof\"));\n\n  var _formData = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[3], \"form-data\"));\n\n  var _errors = _$$_REQUIRE(_dependencyMap[4], \"./errors\");\n\n  var validFeedSlugRe = /^[\\w]+$/;\n  var validUserIdRe = /^[\\w-]+$/;\n\n  function validateFeedSlug(feedSlug) {\n    if (!validFeedSlugRe.test(feedSlug)) {\n      throw new _errors.FeedError(\"Invalid feedSlug, please use letters, numbers or _: \".concat(feedSlug));\n    }\n\n    return feedSlug;\n  }\n\n  function validateUserId(userId) {\n    if (!validUserIdRe.test(userId)) {\n      throw new _errors.FeedError(\"Invalid userId, please use letters, numbers, - or _: \".concat(userId));\n    }\n\n    return userId;\n  }\n\n  function rfc3986(str) {\n    return str.replace(/[!'()*]/g, function (c) {\n      return \"%\".concat(c.charCodeAt(0).toString(16).toUpperCase());\n    });\n  }\n\n  function isReadableStream(obj) {\n    return obj !== null && (0, _typeof2.default)(obj) === 'object' && typeof obj._read === 'function';\n  }\n\n  function validateFeedId(feedId) {\n    var parts = feedId.split(':');\n\n    if (parts.length !== 2) {\n      throw new _errors.FeedError(\"Invalid feedId, expected something like user:1 got \".concat(feedId));\n    }\n\n    var _parts = (0, _slicedToArray2.default)(parts, 2),\n        feedSlug = _parts[0],\n        userId = _parts[1];\n\n    validateFeedSlug(feedSlug);\n    validateUserId(userId);\n    return feedId;\n  }\n\n  function addFileToFormData(uri, name, contentType) {\n    var data = new _formData.default();\n    var fileField;\n\n    if (isReadableStream(uri)) {\n      fileField = uri;\n    } else if (uri && uri.toString && uri.toString() === '[object File]') {\n      fileField = uri;\n    } else {\n      fileField = {\n        uri: uri,\n        name: name || uri.split('/').reverse()[0]\n      };\n      if (contentType != null) fileField.type = contentType;\n    }\n\n    data.append('file', fileField);\n    return data;\n  }\n\n  function replaceStreamObjects(obj) {\n    if (Array.isArray(obj)) return obj.map(function (v) {\n      return replaceStreamObjects(v);\n    });\n    if (Object.prototype.toString.call(obj) !== '[object Object]') return obj;\n    if (typeof obj.ref === 'function') return obj.ref();\n    var cloned = {};\n    Object.keys(obj).forEach(function (k) {\n      cloned[k] = replaceStreamObjects(obj[k]);\n    });\n    return cloned;\n  }\n\n  var _default = {\n    validateFeedId: validateFeedId,\n    validateFeedSlug: validateFeedSlug,\n    validateUserId: validateUserId,\n    rfc3986: rfc3986,\n    isReadableStream: isReadableStream,\n    addFileToFormData: addFileToFormData,\n    replaceStreamObjects: replaceStreamObjects\n  };\n  exports.default = _default;\n});","lineCount":107,"map":[[2,0,1,0],[4,0,3,0],[4,6,3,4,"_interopRequireDefault"],[4,28,3,26],[4,31,3,29,"require"],[4,42,3,36],[4,109,3,0],[6,0,5,0,"Object"],[6,2,5,0,"Object"],[6,8,5,6],[6,9,5,7,"defineProperty"],[6,23,5,0],[6,24,5,22,"exports"],[6,31,5,0],[6,33,5,31],[6,45,5,0],[6,47,5,45],[7,0,6,2,"value"],[7,4,6,2,"value"],[7,9,6,7],[7,11,6,9],[8,0,5,45],[8,3,5,0],[9,0,8,0,"exports"],[9,2,8,0,"exports"],[9,9,8,7],[9,10,8,8,"default"],[9,17,8,0],[9,20,8,18],[9,25,8,23],[9,26,8,0],[11,0,10,0],[11,6,10,4,"_slicedToArray2"],[11,21,10,19],[11,24,10,22,"_interopRequireDefault"],[11,46,10,44],[11,47,10,45,"require"],[11,58,10,52],[11,117,10,44],[11,118,10,0],[13,0,12,0],[13,6,12,4,"_typeof2"],[13,14,12,12],[13,17,12,15,"_interopRequireDefault"],[13,39,12,37],[13,40,12,38,"require"],[13,51,12,45],[13,103,12,37],[13,104,12,0],[15,0,14,0],[15,6,14,4,"_formData"],[15,15,14,13],[15,18,14,16,"_interopRequireDefault"],[15,40,14,38],[15,41,14,39,"require"],[15,52,14,46],[15,84,14,38],[15,85,14,0],[17,0,16,0],[17,6,16,4,"_errors"],[17,13,16,11],[17,16,16,14,"require"],[17,27,16,21],[17,58,16,0],[19,0,18,0],[19,6,18,4,"validFeedSlugRe"],[19,21,18,19],[19,24,18,22],[19,33,18,0],[20,0,19,0],[20,6,19,4,"validUserIdRe"],[20,19,19,17],[20,22,19,20],[20,32,19,0],[22,0,24,0],[22,11,24,9,"validateFeedSlug"],[22,27,24,0],[22,28,24,26,"feedSlug"],[22,36,24,0],[22,38,24,36],[23,0,25,2],[23,8,25,6],[23,9,25,7,"validFeedSlugRe"],[23,24,25,22],[23,25,25,23,"test"],[23,29,25,7],[23,30,25,28,"feedSlug"],[23,38,25,7],[23,39,25,2],[23,41,25,39],[24,0,26,4],[24,12,26,10],[24,16,26,14,"_errors"],[24,23,26,21],[24,24,26,22,"FeedError"],[24,33,26,10],[24,34,26,32],[24,89,26,87,"concat"],[24,95,26,32],[24,96,26,94,"feedSlug"],[24,104,26,32],[24,105,26,10],[24,106,26,4],[25,0,27,3],[27,0,29,2],[27,11,29,9,"feedSlug"],[27,19,29,2],[28,0,30,1],[30,0,36,0],[30,11,36,9,"validateUserId"],[30,25,36,0],[30,26,36,24,"userId"],[30,32,36,0],[30,34,36,32],[31,0,37,2],[31,8,37,6],[31,9,37,7,"validUserIdRe"],[31,22,37,20],[31,23,37,21,"test"],[31,27,37,7],[31,28,37,26,"userId"],[31,34,37,7],[31,35,37,2],[31,37,37,35],[32,0,38,4],[32,12,38,10],[32,16,38,14,"_errors"],[32,23,38,21],[32,24,38,22,"FeedError"],[32,33,38,10],[32,34,38,32],[32,90,38,88,"concat"],[32,96,38,32],[32,97,38,95,"userId"],[32,103,38,32],[32,104,38,10],[32,105,38,4],[33,0,39,3],[35,0,41,2],[35,11,41,9,"userId"],[35,17,41,2],[36,0,42,1],[38,0,44,0],[38,11,44,9,"rfc3986"],[38,18,44,0],[38,19,44,17,"str"],[38,22,44,0],[38,24,44,22],[39,0,45,2],[39,11,45,9,"str"],[39,14,45,12],[39,15,45,13,"replace"],[39,22,45,9],[39,23,45,21],[39,33,45,9],[39,35,45,33],[39,45,45,43,"c"],[39,46,45,33],[39,48,45,46],[40,0,46,4],[40,13,46,11],[40,17,46,15,"concat"],[40,23,46,11],[40,24,46,22,"c"],[40,25,46,23],[40,26,46,24,"charCodeAt"],[40,36,46,22],[40,37,46,35],[40,38,46,22],[40,40,46,38,"toString"],[40,48,46,22],[40,49,46,47],[40,51,46,22],[40,53,46,51,"toUpperCase"],[40,64,46,22],[40,66,46,11],[40,67,46,4],[41,0,47,3],[41,5,45,9],[41,6,45,2],[42,0,48,1],[44,0,50,0],[44,11,50,9,"isReadableStream"],[44,27,50,0],[44,28,50,26,"obj"],[44,31,50,0],[44,33,50,31],[45,0,51,2],[45,11,51,9,"obj"],[45,14,51,12],[45,19,51,17],[45,23,51,9],[45,27,51,25],[45,28,51,26],[45,31,51,29,"_typeof2"],[45,39,51,37],[45,40,51,38,"default"],[45,47,51,25],[45,49,51,47,"obj"],[45,52,51,25],[45,58,51,56],[45,66,51,9],[45,70,51,68],[45,77,51,75,"obj"],[45,80,51,78],[45,81,51,79,"_read"],[45,86,51,68],[45,91,51,89],[45,101,51,2],[46,0,52,1],[48,0,58,0],[48,11,58,9,"validateFeedId"],[48,25,58,0],[48,26,58,24,"feedId"],[48,32,58,0],[48,34,58,32],[49,0,59,2],[49,8,59,6,"parts"],[49,13,59,11],[49,16,59,14,"feedId"],[49,22,59,20],[49,23,59,21,"split"],[49,28,59,14],[49,29,59,27],[49,32,59,14],[49,33,59,2],[51,0,61,2],[51,8,61,6,"parts"],[51,13,61,11],[51,14,61,12,"length"],[51,20,61,6],[51,25,61,23],[51,26,61,2],[51,28,61,26],[52,0,62,4],[52,12,62,10],[52,16,62,14,"_errors"],[52,23,62,21],[52,24,62,22,"FeedError"],[52,33,62,10],[52,34,62,32],[52,88,62,86,"concat"],[52,94,62,32],[52,95,62,93,"feedId"],[52,101,62,32],[52,102,62,10],[52,103,62,4],[53,0,63,3],[55,0,65,2],[55,8,65,6,"_parts"],[55,14,65,12],[55,17,65,15],[55,18,65,16],[55,21,65,19,"_slicedToArray2"],[55,36,65,34],[55,37,65,35,"default"],[55,44,65,15],[55,46,65,44,"parts"],[55,51,65,15],[55,53,65,51],[55,54,65,15],[55,55,65,2],[56,0,65,2],[56,8,66,6,"feedSlug"],[56,16,66,14],[56,19,66,17,"_parts"],[56,25,66,23],[56,26,66,24],[56,27,66,23],[56,28,65,2],[57,0,65,2],[57,8,67,6,"userId"],[57,14,67,12],[57,17,67,15,"_parts"],[57,23,67,21],[57,24,67,22],[57,25,67,21],[57,26,65,2],[59,0,69,2,"validateFeedSlug"],[59,4,69,2,"validateFeedSlug"],[59,20,69,18],[59,21,69,19,"feedSlug"],[59,29,69,18],[59,30,69,2],[60,0,70,2,"validateUserId"],[60,4,70,2,"validateUserId"],[60,18,70,16],[60,19,70,17,"userId"],[60,25,70,16],[60,26,70,2],[61,0,71,2],[61,11,71,9,"feedId"],[61,17,71,2],[62,0,72,1],[64,0,74,0],[64,11,74,9,"addFileToFormData"],[64,28,74,0],[64,29,74,27,"uri"],[64,32,74,0],[64,34,74,32,"name"],[64,38,74,0],[64,40,74,38,"contentType"],[64,51,74,0],[64,53,74,51],[65,0,75,2],[65,8,75,6,"data"],[65,12,75,10],[65,15,75,13],[65,19,75,17,"_formData"],[65,28,75,26],[65,29,75,27,"default"],[65,36,75,13],[65,38,75,2],[66,0,76,2],[66,8,76,6,"fileField"],[66,17,76,2],[68,0,78,2],[68,8,78,6,"isReadableStream"],[68,24,78,22],[68,25,78,23,"uri"],[68,28,78,22],[68,29,78,2],[68,31,78,29],[69,0,79,4,"fileField"],[69,6,79,4,"fileField"],[69,15,79,13],[69,18,79,16,"uri"],[69,21,79,4],[70,0,80,3],[70,5,78,2],[70,11,80,9],[70,15,80,13,"uri"],[70,18,80,16],[70,22,80,20,"uri"],[70,25,80,23],[70,26,80,24,"toString"],[70,34,80,13],[70,38,80,36,"uri"],[70,41,80,39],[70,42,80,40,"toString"],[70,50,80,36],[70,57,80,55],[70,72,80,9],[70,74,80,72],[71,0,81,4,"fileField"],[71,6,81,4,"fileField"],[71,15,81,13],[71,18,81,16,"uri"],[71,21,81,4],[72,0,82,3],[72,5,80,9],[72,11,82,9],[73,0,83,4,"fileField"],[73,6,83,4,"fileField"],[73,15,83,13],[73,18,83,16],[74,0,84,6,"uri"],[74,8,84,6,"uri"],[74,11,84,9],[74,13,84,11,"uri"],[74,16,83,16],[75,0,85,6,"name"],[75,8,85,6,"name"],[75,12,85,10],[75,14,85,12,"name"],[75,18,85,16],[75,22,85,20,"uri"],[75,25,85,23],[75,26,85,24,"split"],[75,31,85,20],[75,32,85,30],[75,35,85,20],[75,37,85,35,"reverse"],[75,44,85,20],[75,47,85,45],[75,48,85,20],[76,0,83,16],[76,7,83,4],[77,0,87,4],[77,10,87,8,"contentType"],[77,21,87,19],[77,25,87,23],[77,29,87,4],[77,31,87,29,"fileField"],[77,40,87,38],[77,41,87,39,"type"],[77,45,87,29],[77,48,87,46,"contentType"],[77,59,87,29],[78,0,88,3],[80,0,90,2,"data"],[80,4,90,2,"data"],[80,8,90,6],[80,9,90,7,"append"],[80,15,90,2],[80,16,90,14],[80,22,90,2],[80,24,90,22,"fileField"],[80,33,90,2],[81,0,91,2],[81,11,91,9,"data"],[81,15,91,2],[82,0,92,1],[84,0,95,0],[84,11,95,9,"replaceStreamObjects"],[84,31,95,0],[84,32,95,30,"obj"],[84,35,95,0],[84,37,95,35],[85,0,97,2],[85,8,97,6,"Array"],[85,13,97,11],[85,14,97,12,"isArray"],[85,21,97,6],[85,22,97,20,"obj"],[85,25,97,6],[85,26,97,2],[85,28,97,26],[85,35,97,33,"obj"],[85,38,97,36],[85,39,97,37,"map"],[85,42,97,33],[85,43,97,41],[85,53,97,51,"v"],[85,54,97,41],[85,56,97,54],[86,0,98,4],[86,13,98,11,"replaceStreamObjects"],[86,33,98,31],[86,34,98,32,"v"],[86,35,98,31],[86,36,98,4],[87,0,99,3],[87,5,97,33],[87,6,97,26],[88,0,101,2],[88,8,101,6,"Object"],[88,14,101,12],[88,15,101,13,"prototype"],[88,24,101,6],[88,25,101,23,"toString"],[88,33,101,6],[88,34,101,32,"call"],[88,38,101,6],[88,39,101,37,"obj"],[88,42,101,6],[88,48,101,46],[88,65,101,2],[88,67,101,65],[88,74,101,72,"obj"],[88,77,101,65],[89,0,103,2],[89,8,103,6],[89,15,103,13,"obj"],[89,18,103,16],[89,19,103,17,"ref"],[89,22,103,6],[89,27,103,25],[89,37,103,2],[89,39,103,37],[89,46,103,44,"obj"],[89,49,103,47],[89,50,103,48,"ref"],[89,53,103,44],[89,55,103,37],[90,0,104,2],[90,8,104,6,"cloned"],[90,14,104,12],[90,17,104,15],[90,19,104,2],[91,0,105,2,"Object"],[91,4,105,2,"Object"],[91,10,105,8],[91,11,105,9,"keys"],[91,15,105,2],[91,16,105,14,"obj"],[91,19,105,2],[91,21,105,19,"forEach"],[91,28,105,2],[91,29,105,27],[91,39,105,37,"k"],[91,40,105,27],[91,42,105,40],[92,0,107,4,"cloned"],[92,6,107,4,"cloned"],[92,12,107,10],[92,13,107,11,"k"],[92,14,107,10],[92,15,107,4],[92,18,107,16,"replaceStreamObjects"],[92,38,107,36],[92,39,107,37,"obj"],[92,42,107,40],[92,43,107,41,"k"],[92,44,107,40],[92,45,107,36],[92,46,107,4],[93,0,108,3],[93,5,105,2],[94,0,110,2],[94,11,110,9,"cloned"],[94,17,110,2],[95,0,111,1],[97,0,113,0],[97,6,113,4,"_default"],[97,14,113,12],[97,17,113,15],[98,0,114,2,"validateFeedId"],[98,4,114,2,"validateFeedId"],[98,18,114,16],[98,20,114,18,"validateFeedId"],[98,34,113,15],[99,0,115,2,"validateFeedSlug"],[99,4,115,2,"validateFeedSlug"],[99,20,115,18],[99,22,115,20,"validateFeedSlug"],[99,38,113,15],[100,0,116,2,"validateUserId"],[100,4,116,2,"validateUserId"],[100,18,116,16],[100,20,116,18,"validateUserId"],[100,34,113,15],[101,0,117,2,"rfc3986"],[101,4,117,2,"rfc3986"],[101,11,117,9],[101,13,117,11,"rfc3986"],[101,20,113,15],[102,0,118,2,"isReadableStream"],[102,4,118,2,"isReadableStream"],[102,20,118,18],[102,22,118,20,"isReadableStream"],[102,38,113,15],[103,0,119,2,"addFileToFormData"],[103,4,119,2,"addFileToFormData"],[103,21,119,19],[103,23,119,21,"addFileToFormData"],[103,40,113,15],[104,0,120,2,"replaceStreamObjects"],[104,4,120,2,"replaceStreamObjects"],[104,24,120,22],[104,26,120,24,"replaceStreamObjects"],[105,0,113,15],[105,3,113,0],[106,0,122,0,"exports"],[106,2,122,0,"exports"],[106,9,122,7],[106,10,122,8,"default"],[106,17,122,0],[106,20,122,18,"_default"],[106,28,122,0]],"functionMap":{"names":["<global>","validateFeedSlug","validateUserId","rfc3986","str.replace$argument_1","isReadableStream","validateFeedId","addFileToFormData","replaceStreamObjects","obj.map$argument_0","Object.keys.forEach$argument_0"],"mappings":"AAA;ACuB;CDM;AEM;CFM;AGE;iCCC;GDE;CHC;AKE;CLE;AMM;CNc;AOE;CPkB;AQG;yCCE;GDE;2BEM;GFG;CRG"}},"type":"js/module"}]}