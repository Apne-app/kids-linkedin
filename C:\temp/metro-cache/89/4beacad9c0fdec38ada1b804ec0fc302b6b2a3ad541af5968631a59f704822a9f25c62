{"dependencies":[{"name":"../util/class","data":{"isAsync":false,"locs":[{"start":{"line":3,"column":17},"end":{"line":3,"column":41}}]}},{"name":"../util/assign","data":{"isAsync":false,"locs":[{"start":{"line":4,"column":17},"end":{"line":4,"column":42}}]}},{"name":"../mixins/deferrable","data":{"isAsync":false,"locs":[{"start":{"line":5,"column":17},"end":{"line":5,"column":48}}]}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  var Class = _$$_REQUIRE(_dependencyMap[0], \"../util/class\"),\n      assign = _$$_REQUIRE(_dependencyMap[1], \"../util/assign\"),\n      Deferrable = _$$_REQUIRE(_dependencyMap[2], \"../mixins/deferrable\");\n\n  var Subscription = Class({\n    initialize: function initialize(client, channels, callback, context) {\n      this._client = client;\n      this._channels = channels;\n      this._callback = callback;\n      this._context = context;\n      this._cancelled = false;\n    },\n    withChannel: function withChannel(callback, context) {\n      this._withChannel = [callback, context];\n      return this;\n    },\n    apply: function apply(context, args) {\n      var message = args[0];\n      if (this._callback) this._callback.call(this._context, message.data);\n      if (this._withChannel) this._withChannel[0].call(this._withChannel[1], message.channel, message.data);\n    },\n    cancel: function cancel() {\n      if (this._cancelled) return;\n\n      this._client.unsubscribe(this._channels, this);\n\n      this._cancelled = true;\n    },\n    unsubscribe: function unsubscribe() {\n      this.cancel();\n    }\n  });\n  assign(Subscription.prototype, Deferrable);\n  module.exports = Subscription;\n});","lineCount":38,"map":[[2,0,1,0],[4,0,3,0],[4,6,3,4,"Class"],[4,11,3,9],[4,14,3,17,"require"],[4,25,3,24],[4,61,3,0],[5,0,3,0],[5,6,4,4,"assign"],[5,12,4,10],[5,15,4,17,"require"],[5,26,4,24],[5,63,3,0],[6,0,3,0],[6,6,5,4,"Deferrable"],[6,16,5,14],[6,19,5,17,"require"],[6,30,5,24],[6,73,3,0],[8,0,7,0],[8,6,7,4,"Subscription"],[8,18,7,16],[8,21,7,19,"Class"],[8,26,7,24],[8,27,7,25],[9,0,8,2,"initialize"],[9,4,8,2,"initialize"],[9,14,8,12],[9,16,8,14],[9,36,8,23,"client"],[9,42,8,14],[9,44,8,31,"channels"],[9,52,8,14],[9,54,8,41,"callback"],[9,62,8,14],[9,64,8,51,"context"],[9,71,8,14],[9,73,8,60],[10,0,9,4],[10,11,9,9,"_client"],[10,18,9,4],[10,21,9,22,"client"],[10,27,9,4],[11,0,10,4],[11,11,10,9,"_channels"],[11,20,10,4],[11,23,10,22,"channels"],[11,31,10,4],[12,0,11,4],[12,11,11,9,"_callback"],[12,20,11,4],[12,23,11,22,"callback"],[12,31,11,4],[13,0,12,4],[13,11,12,9,"_context"],[13,19,12,4],[13,22,12,22,"context"],[13,29,12,4],[14,0,13,4],[14,11,13,9,"_cancelled"],[14,21,13,4],[14,24,13,22],[14,29,13,4],[15,0,14,3],[15,5,7,25],[16,0,16,2,"withChannel"],[16,4,16,2,"withChannel"],[16,15,16,13],[16,17,16,15],[16,38,16,24,"callback"],[16,46,16,15],[16,48,16,34,"context"],[16,55,16,15],[16,57,16,43],[17,0,17,4],[17,11,17,9,"_withChannel"],[17,23,17,4],[17,26,17,24],[17,27,17,25,"callback"],[17,35,17,24],[17,37,17,35,"context"],[17,44,17,24],[17,45,17,4],[18,0,18,4],[18,13,18,11],[18,17,18,4],[19,0,19,3],[19,5,7,25],[20,0,21,2,"apply"],[20,4,21,2,"apply"],[20,9,21,7],[20,11,21,9],[20,26,21,18,"context"],[20,33,21,9],[20,35,21,27,"args"],[20,39,21,9],[20,41,21,33],[21,0,22,4],[21,10,22,8,"message"],[21,17,22,15],[21,20,22,18,"args"],[21,24,22,22],[21,25,22,23],[21,26,22,22],[21,27,22,4],[22,0,24,4],[22,10,24,8],[22,15,24,13,"_callback"],[22,24,24,4],[22,26,25,6],[22,31,25,11,"_callback"],[22,40,25,6],[22,41,25,21,"call"],[22,45,25,6],[22,46,25,26],[22,51,25,31,"_context"],[22,59,25,6],[22,61,25,41,"message"],[22,68,25,48],[22,69,25,49,"data"],[22,73,25,6],[23,0,27,4],[23,10,27,8],[23,15,27,13,"_withChannel"],[23,27,27,4],[23,29,28,6],[23,34,28,11,"_withChannel"],[23,46,28,6],[23,47,28,24],[23,48,28,6],[23,50,28,27,"call"],[23,54,28,6],[23,55,28,32],[23,60,28,37,"_withChannel"],[23,72,28,32],[23,73,28,50],[23,74,28,32],[23,75,28,6],[23,77,28,54,"message"],[23,84,28,61],[23,85,28,62,"channel"],[23,92,28,6],[23,94,28,71,"message"],[23,101,28,78],[23,102,28,79,"data"],[23,106,28,6],[24,0,29,3],[24,5,7,25],[25,0,31,2,"cancel"],[25,4,31,2,"cancel"],[25,10,31,8],[25,12,31,10],[25,30,31,21],[26,0,32,4],[26,10,32,8],[26,15,32,13,"_cancelled"],[26,25,32,4],[26,27,32,25],[28,0,33,4],[28,11,33,9,"_client"],[28,18,33,4],[28,19,33,17,"unsubscribe"],[28,30,33,4],[28,31,33,29],[28,36,33,34,"_channels"],[28,45,33,4],[28,47,33,45],[28,51,33,4],[30,0,34,4],[30,11,34,9,"_cancelled"],[30,21,34,4],[30,24,34,22],[30,28,34,4],[31,0,35,3],[31,5,7,25],[32,0,37,2,"unsubscribe"],[32,4,37,2,"unsubscribe"],[32,15,37,13],[32,17,37,15],[32,40,37,26],[33,0,38,4],[33,11,38,9,"cancel"],[33,17,38,4],[34,0,39,3],[35,0,7,25],[35,3,7,24],[35,4,7,0],[36,0,42,0,"assign"],[36,2,42,0,"assign"],[36,8,42,6],[36,9,42,7,"Subscription"],[36,21,42,19],[36,22,42,20,"prototype"],[36,31,42,6],[36,33,42,31,"Deferrable"],[36,43,42,6],[36,44,42,0],[37,0,44,0,"module"],[37,2,44,0,"module"],[37,8,44,6],[37,9,44,7,"exports"],[37,16,44,0],[37,19,44,17,"Subscription"],[37,31,44,0]],"functionMap":{"names":["<global>","Class$argument_0.initialize","Class$argument_0.withChannel","Class$argument_0.apply","Class$argument_0.cancel","Class$argument_0.unsubscribe"],"mappings":"AAA;cCO;GDM;eEE;GFG;SGE;GHQ;UIE;GJI;eKE;GLE"}},"type":"js/module"}]}