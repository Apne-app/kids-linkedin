{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"isAsync":false}},{"name":"../base","data":{"isAsync":false}},{"name":"../core/AnimatedClock","data":{"isAsync":false}},{"name":"../derived/evaluateOnce","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = backwardsCompatibleAnimWrapper;\n\n  var _base = _$$_REQUIRE(_dependencyMap[1], \"../base\");\n\n  var _AnimatedClock = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[2], \"../core/AnimatedClock\"));\n\n  var _evaluateOnce = _$$_REQUIRE(_dependencyMap[3], \"../derived/evaluateOnce\");\n\n  function createOldAnimationObject(node, animationStateDefaults, value, config) {\n    var newClock = new _AnimatedClock.default();\n    var currentState = animationStateDefaults();\n    var alwaysNode;\n    var isStarted = false;\n    var isDone = false;\n    var wasStopped = false;\n    var animationCallback;\n    var animation = {\n      start: function start(currentAnimationCallback) {\n        animationCallback = currentAnimationCallback;\n\n        if (isStarted) {\n          animationCallback && animationCallback({\n            finished: false\n          });\n          return;\n        }\n\n        if (isDone) {\n          console.warn('Animation has been finished before');\n          return;\n        }\n\n        if (!value.isNativelyInitialized()) {\n          return;\n        }\n\n        isStarted = true;\n        (0, _evaluateOnce.evaluateOnce)((0, _base.set)(currentState.position, value), currentState.position, function () {\n          alwaysNode = (0, _base.always)((0, _base.set)(value, (0, _base.block)([(0, _base.cond)((0, _base.clockRunning)(newClock), 0, (0, _base.startClock)(newClock)), node(newClock, currentState, config), (0, _base.cond)(currentState.finished, [(0, _base.call)([], function () {\n            isStarted = false;\n\n            if (!wasStopped) {\n              isDone = true;\n            }\n\n            value.__detachAnimation(animation);\n\n            isDone = true;\n\n            if (!wasStopped) {\n              wasStopped = false;\n            }\n          }), (0, _base.stopClock)(newClock)]), currentState.position])));\n\n          value.__attachAnimation(animation);\n\n          alwaysNode.__addChild(value);\n        });\n      },\n      __detach: function __detach() {\n        animationCallback && animationCallback({\n          finished: isDone\n        });\n        animationCallback = null;\n        value.__initialized && alwaysNode.__removeChild(value);\n      },\n      stop: function stop() {\n        if (isDone) {\n          console.warn('Calling stop has no effect as the animation has already completed');\n          return;\n        }\n\n        if (!isStarted) {\n          console.warn(\"Calling stop has no effect as the animation hasn't been started\");\n          return;\n        }\n\n        wasStopped = true;\n        (0, _evaluateOnce.evaluateOnce)((0, _base.set)(currentState.finished, 1), currentState.finished);\n      },\n      __stopImmediately_testOnly: function __stopImmediately_testOnly(result) {\n        animation.stop();\n        isDone = result;\n\n        value.__detachAnimation(animation);\n      }\n    };\n    return animation;\n  }\n\n  function backwardsCompatibleAnimWrapper(node, animationStateDefaults) {\n    return function (clock, state, config) {\n      if (config !== undefined) {\n        return node(clock, state, config);\n      }\n\n      return createOldAnimationObject(node, animationStateDefaults, clock, state);\n    };\n  }\n});","lineCount":106,"map":[[9,0,1,0],[11,0,11,0],[13,0,12,0],[15,0,14,0],[15,11,14,9,"createOldAnimationObject"],[15,35,14,0],[15,36,14,34,"node"],[15,40,14,0],[15,42,14,40,"animationStateDefaults"],[15,64,14,0],[15,66,14,64,"value"],[15,71,14,0],[15,73,14,71,"config"],[15,79,14,0],[15,81,14,79],[16,0,15,2],[16,8,15,8,"newClock"],[16,16,15,16],[16,19,15,19],[16,23,15,23,"Clock"],[16,45,15,19],[16,47,15,2],[17,0,16,2],[17,8,16,8,"currentState"],[17,20,16,20],[17,23,16,23,"animationStateDefaults"],[17,45,16,45],[17,47,16,2],[18,0,17,2],[18,8,17,6,"alwaysNode"],[18,18,17,2],[19,0,18,2],[19,8,18,6,"isStarted"],[19,17,18,15],[19,20,18,18],[19,25,18,2],[20,0,19,2],[20,8,19,6,"isDone"],[20,14,19,12],[20,17,19,15],[20,22,19,2],[21,0,20,2],[21,8,20,6,"wasStopped"],[21,18,20,16],[21,21,20,19],[21,26,20,2],[22,0,21,2],[22,8,21,6,"animationCallback"],[22,25,21,2],[23,0,22,2],[23,8,22,8,"animation"],[23,17,22,17],[23,20,22,20],[24,0,23,4,"start"],[24,6,23,4,"start"],[24,11,23,9],[24,13,23,11],[24,28,23,11,"currentAnimationCallback"],[24,52,23,35],[24,54,23,39],[25,0,24,6,"animationCallback"],[25,8,24,6,"animationCallback"],[25,25,24,23],[25,28,24,26,"currentAnimationCallback"],[25,52,24,6],[27,0,25,6],[27,12,25,10,"isStarted"],[27,21,25,6],[27,23,25,21],[28,0,26,8,"animationCallback"],[28,10,26,8,"animationCallback"],[28,27,26,25],[28,31,26,29,"animationCallback"],[28,48,26,46],[28,49,26,47],[29,0,26,49,"finished"],[29,12,26,49,"finished"],[29,20,26,57],[29,22,26,59],[30,0,26,47],[30,11,26,46],[30,12,26,8],[31,0,27,8],[32,0,28,7],[34,0,29,6],[34,12,29,10,"isDone"],[34,18,29,6],[34,20,29,18],[35,0,30,8,"console"],[35,10,30,8,"console"],[35,17,30,15],[35,18,30,16,"warn"],[35,22,30,8],[35,23,30,21],[35,59,30,8],[36,0,32,8],[37,0,33,7],[39,0,35,6],[39,12,35,10],[39,13,35,11,"value"],[39,18,35,16],[39,19,35,17,"isNativelyInitialized"],[39,40,35,11],[39,42,35,6],[39,44,35,42],[40,0,36,8],[41,0,37,7],[43,0,39,6,"isStarted"],[43,8,39,6,"isStarted"],[43,17,39,15],[43,20,39,18],[43,24,39,6],[44,0,40,6],[44,40,41,8],[44,55,41,12,"currentState"],[44,67,41,24],[44,68,41,25,"position"],[44,76,41,8],[44,78,41,35,"value"],[44,83,41,8],[44,84,40,6],[44,86,42,8,"currentState"],[44,98,42,20],[44,99,42,21,"position"],[44,107,40,6],[44,109,43,8],[44,121,43,14],[45,0,44,10,"alwaysNode"],[45,10,44,10,"alwaysNode"],[45,20,44,20],[45,23,44,23],[45,41,45,12],[45,56,46,14,"value"],[45,61,45,12],[45,63,47,14],[45,80,47,20],[45,81,48,16],[45,97,48,21],[45,121,48,34,"newClock"],[45,129,48,21],[45,130,48,16],[45,132,48,45],[45,133,48,16],[45,135,48,48],[45,157,48,59,"newClock"],[45,165,48,48],[45,166,48,16],[45,167,47,20],[45,169,49,16,"node"],[45,173,49,20],[45,174,49,21,"newClock"],[45,182,49,20],[45,184,49,31,"currentState"],[45,196,49,20],[45,198,49,45,"config"],[45,204,49,20],[45,205,47,20],[45,207,50,16],[45,223,50,21,"currentState"],[45,235,50,33],[45,236,50,34,"finished"],[45,244,50,16],[45,246,50,44],[45,247,51,18],[45,263,51,23],[45,265,51,18],[45,267,51,27],[45,279,51,33],[46,0,52,20,"isStarted"],[46,12,52,20,"isStarted"],[46,21,52,29],[46,24,52,32],[46,29,52,20],[48,0,53,20],[48,16,53,24],[48,17,53,25,"wasStopped"],[48,27,53,20],[48,29,53,37],[49,0,54,22,"isDone"],[49,14,54,22,"isDone"],[49,20,54,28],[49,23,54,31],[49,27,54,22],[50,0,55,21],[52,0,56,20,"value"],[52,12,56,20,"value"],[52,17,56,25],[52,18,56,26,"__detachAnimation"],[52,35,56,20],[52,36,56,44,"animation"],[52,45,56,20],[54,0,57,20,"isDone"],[54,12,57,20,"isDone"],[54,18,57,26],[54,21,57,29],[54,25,57,20],[56,0,58,20],[56,16,58,24],[56,17,58,25,"wasStopped"],[56,27,58,20],[56,29,58,37],[57,0,59,22,"wasStopped"],[57,14,59,22,"wasStopped"],[57,24,59,32],[57,27,59,35],[57,32,59,22],[58,0,60,21],[59,0,61,19],[59,11,51,18],[59,12,50,44],[59,14,62,18],[59,35,62,28,"newClock"],[59,43,62,18],[59,44,50,44],[59,45,50,16],[59,46,47,20],[59,48,64,16,"currentState"],[59,60,64,28],[59,61,64,29,"position"],[59,69,47,20],[59,70,47,14],[59,71,45,12],[59,72,44,23],[59,73,44,10],[61,0,68,10,"value"],[61,10,68,10,"value"],[61,15,68,15],[61,16,68,16,"__attachAnimation"],[61,33,68,10],[61,34,68,34,"animation"],[61,43,68,10],[63,0,69,10,"alwaysNode"],[63,10,69,10,"alwaysNode"],[63,20,69,20],[63,21,69,21,"__addChild"],[63,31,69,10],[63,32,69,32,"value"],[63,37,69,10],[64,0,70,9],[64,9,40,6],[65,0,72,5],[65,7,22,20],[66,0,73,4,"__detach"],[66,6,73,4,"__detach"],[66,14,73,12],[66,16,73,14],[66,36,73,20],[67,0,74,6,"animationCallback"],[67,8,74,6,"animationCallback"],[67,25,74,23],[67,29,74,27,"animationCallback"],[67,46,74,44],[67,47,74,45],[68,0,74,47,"finished"],[68,10,74,47,"finished"],[68,18,74,55],[68,20,74,57,"isDone"],[69,0,74,45],[69,9,74,44],[69,10,74,6],[70,0,75,6,"animationCallback"],[70,8,75,6,"animationCallback"],[70,25,75,23],[70,28,75,26],[70,32,75,6],[71,0,76,6,"value"],[71,8,76,6,"value"],[71,13,76,11],[71,14,76,12,"__initialized"],[71,27,76,6],[71,31,76,29,"alwaysNode"],[71,41,76,39],[71,42,76,40,"__removeChild"],[71,55,76,29],[71,56,76,54,"value"],[71,61,76,29],[71,62,76,6],[72,0,77,5],[72,7,22,20],[73,0,78,4,"stop"],[73,6,78,4,"stop"],[73,10,78,8],[73,12,78,10],[73,28,78,16],[74,0,79,6],[74,12,79,10,"isDone"],[74,18,79,6],[74,20,79,18],[75,0,80,8,"console"],[75,10,80,8,"console"],[75,17,80,15],[75,18,80,16,"warn"],[75,22,80,8],[75,23,81,10],[75,90,80,8],[76,0,83,8],[77,0,84,7],[79,0,85,6],[79,12,85,10],[79,13,85,11,"isStarted"],[79,22,85,6],[79,24,85,22],[80,0,86,8,"console"],[80,10,86,8,"console"],[80,17,86,15],[80,18,86,16,"warn"],[80,22,86,8],[80,23,87,10],[80,88,86,8],[81,0,89,8],[82,0,90,7],[84,0,91,6,"wasStopped"],[84,8,91,6,"wasStopped"],[84,18,91,16],[84,21,91,19],[84,25,91,6],[85,0,92,6],[85,40,92,19],[85,55,92,23,"currentState"],[85,67,92,35],[85,68,92,36,"finished"],[85,76,92,19],[85,78,92,46],[85,79,92,19],[85,80,92,6],[85,82,92,50,"currentState"],[85,94,92,62],[85,95,92,63,"finished"],[85,103,92,6],[86,0,93,5],[86,7,22,20],[87,0,94,4,"__stopImmediately_testOnly"],[87,6,94,4,"__stopImmediately_testOnly"],[87,32,94,30],[87,34,94,32],[87,70,94,32,"result"],[87,76,94,38],[87,78,94,42],[88,0,95,6,"animation"],[88,8,95,6,"animation"],[88,17,95,15],[88,18,95,16,"stop"],[88,22,95,6],[89,0,96,6,"isDone"],[89,8,96,6,"isDone"],[89,14,96,12],[89,17,96,15,"result"],[89,23,96,6],[91,0,97,6,"value"],[91,8,97,6,"value"],[91,13,97,11],[91,14,97,12,"__detachAnimation"],[91,31,97,6],[91,32,97,30,"animation"],[91,41,97,6],[92,0,98,5],[93,0,22,20],[93,5,22,2],[94,0,100,2],[94,11,100,9,"animation"],[94,20,100,2],[95,0,101,1],[97,0,107,15],[97,11,107,24,"backwardsCompatibleAnimWrapper"],[97,41,107,15],[97,42,108,2,"node"],[97,46,107,15],[97,48,109,2,"animationStateDefaults"],[97,70,107,15],[97,72,110,2],[98,0,111,2],[98,11,111,9],[98,21,111,10,"clock"],[98,26,111,9],[98,28,111,17,"state"],[98,33,111,9],[98,35,111,24,"config"],[98,41,111,9],[98,43,111,35],[99,0,112,4],[99,10,112,8,"config"],[99,16,112,14],[99,21,112,19,"undefined"],[99,30,112,4],[99,32,112,30],[100,0,113,6],[100,15,113,13,"node"],[100,19,113,17],[100,20,113,18,"clock"],[100,25,113,17],[100,27,113,25,"state"],[100,32,113,17],[100,34,113,32,"config"],[100,40,113,17],[100,41,113,6],[101,0,114,5],[103,0,115,4],[103,13,115,11,"createOldAnimationObject"],[103,37,115,35],[103,38,115,36,"node"],[103,42,115,35],[103,44,115,42,"animationStateDefaults"],[103,66,115,35],[103,68,115,66,"clock"],[103,73,115,35],[103,75,115,73,"state"],[103,80,115,35],[103,81,115,4],[104,0,116,3],[104,5,111,2],[105,0,117,1]],"functionMap":{"names":["<global>","createOldAnimationObject","animation.start","evaluateOnce$argument_2","call$argument_1","animation.__detach","animation.stop","animation.__stopImmediately_testOnly","backwardsCompatibleAnimWrapper","<anonymous>"],"mappings":"AAA;ACa;WCS;QCoB;2BCQ;mBDU;SDS;KDE;cIC;KJI;UKC;KLe;gCMC;KNI;CDG;eQM;SCI;GDK;CRC"}},"type":"js/module"}]}