{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireWildcard","data":{"isAsync":false}},{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"isAsync":false}},{"name":"@babel/runtime/helpers/defineProperty","data":{"isAsync":false}},{"name":"react","data":{"isAsync":false}},{"name":"./NavigationBuilderContext","data":{"isAsync":false}},{"name":"./NavigationRouteContext","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireWildcard = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireWildcard\");\n\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/helpers/interopRequireDefault\");\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = useOnPreventRemove;\n  exports.shouldPreventRemove = void 0;\n\n  var _defineProperty2 = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[2], \"@babel/runtime/helpers/defineProperty\"));\n\n  var React = _interopRequireWildcard(_$$_REQUIRE(_dependencyMap[3], \"react\"));\n\n  var _NavigationBuilderContext = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[4], \"./NavigationBuilderContext\"));\n\n  var _NavigationRouteContext = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[5], \"./NavigationRouteContext\"));\n\n  function _createForOfIteratorHelperLoose(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } it = o[Symbol.iterator](); return it.next.bind(it); }\n\n  function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\n  function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n  function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\n  function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n  var VISITED_ROUTE_KEYS = Symbol('VISITED_ROUTE_KEYS');\n\n  var shouldPreventRemove = function shouldPreventRemove(emitter, beforeRemoveListeners, currentRoutes, nextRoutes, action) {\n    var _action$VISITED_ROUTE;\n\n    var nextRouteKeys = nextRoutes.map(function (route) {\n      return route.key;\n    });\n    var removedRoutes = currentRoutes.filter(function (route) {\n      return !nextRouteKeys.includes(route.key);\n    }).reverse();\n    var visitedRouteKeys = (_action$VISITED_ROUTE = action[VISITED_ROUTE_KEYS]) != null ? _action$VISITED_ROUTE : new Set();\n\n    var beforeRemoveAction = _objectSpread(_objectSpread({}, action), {}, (0, _defineProperty2.default)({}, VISITED_ROUTE_KEYS, visitedRouteKeys));\n\n    for (var _iterator = _createForOfIteratorHelperLoose(removedRoutes), _step; !(_step = _iterator()).done;) {\n      var _beforeRemoveListener;\n\n      var route = _step.value;\n\n      if (visitedRouteKeys.has(route.key)) {\n        continue;\n      }\n\n      var isPrevented = (_beforeRemoveListener = beforeRemoveListeners[route.key]) == null ? void 0 : _beforeRemoveListener.call(beforeRemoveListeners, beforeRemoveAction);\n\n      if (isPrevented) {\n        return true;\n      }\n\n      visitedRouteKeys.add(route.key);\n      var event = emitter.emit({\n        type: 'beforeRemove',\n        target: route.key,\n        data: {\n          action: beforeRemoveAction\n        },\n        canPreventDefault: true\n      });\n\n      if (event.defaultPrevented) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  exports.shouldPreventRemove = shouldPreventRemove;\n\n  function useOnPreventRemove(_ref) {\n    var getState = _ref.getState,\n        emitter = _ref.emitter,\n        beforeRemoveListeners = _ref.beforeRemoveListeners;\n\n    var _React$useContext = React.useContext(_NavigationBuilderContext.default),\n        addKeyedListener = _React$useContext.addKeyedListener;\n\n    var route = React.useContext(_NavigationRouteContext.default);\n    var routeKey = route == null ? void 0 : route.key;\n    React.useEffect(function () {\n      if (routeKey) {\n        return addKeyedListener == null ? void 0 : addKeyedListener('beforeRemove', routeKey, function (action) {\n          var state = getState();\n          return shouldPreventRemove(emitter, beforeRemoveListeners, state.routes, [], action);\n        });\n      }\n    }, [addKeyedListener, beforeRemoveListeners, emitter, getState, routeKey]);\n  }\n});","lineCount":99,"map":[[14,0,1,0],[16,0,6,0],[18,0,9,0],[30,0,19,0],[30,6,19,6,"VISITED_ROUTE_KEYS"],[30,24,19,24],[30,27,19,27,"Symbol"],[30,33,19,33],[30,34,19,34],[30,54,19,33],[30,55,19,0],[32,0,21,7],[32,6,21,13,"shouldPreventRemove"],[32,25,21,32],[32,28,21,35],[32,37,21,13,"shouldPreventRemove"],[32,56,21,35],[32,57,22,2,"emitter"],[32,64,21,35],[32,66,23,2,"beforeRemoveListeners"],[32,87,21,35],[32,89,24,2,"currentRoutes"],[32,102,21,35],[32,104,25,2,"nextRoutes"],[32,114,21,35],[32,116,26,2,"action"],[32,122,21,35],[32,124,27,5],[33,0,27,5],[35,0,28,2],[35,8,28,8,"nextRouteKeys"],[35,21,28,21],[35,24,28,24,"nextRoutes"],[35,34,28,34],[35,35,28,35,"map"],[35,38,28,24],[35,39,28,39],[35,49,28,40,"route"],[35,54,28,39],[36,0,28,39],[36,13,28,50,"route"],[36,18,28,55],[36,19,28,56,"key"],[36,22,28,39],[37,0,28,39],[37,5,28,24],[37,6,28,2],[38,0,31,2],[38,8,31,8,"removedRoutes"],[38,21,31,21],[38,24,31,24,"currentRoutes"],[38,37,31,37],[38,38,32,5,"filter"],[38,44,31,24],[38,45,32,12],[38,55,32,13,"route"],[38,60,32,12],[39,0,32,12],[39,13,32,23],[39,14,32,24,"nextRouteKeys"],[39,27,32,37],[39,28,32,38,"includes"],[39,36,32,24],[39,37,32,47,"route"],[39,42,32,52],[39,43,32,53,"key"],[39,46,32,24],[39,47,32,12],[40,0,32,12],[40,5,31,24],[40,7,33,5,"reverse"],[40,14,31,24],[40,16,31,2],[41,0,35,2],[41,8,35,8,"visitedRouteKeys"],[41,24,35,37],[41,52,37,4,"action"],[41,58,37,10],[41,59,37,11,"VISITED_ROUTE_KEYS"],[41,77,37,10],[41,78,35,37],[41,114,37,34],[41,118,37,38,"Set"],[41,121,37,34],[41,123,35,2],[43,0,39,2],[43,8,39,8,"beforeRemoveAction"],[43,26,39,26],[43,61,40,7,"action"],[43,67,39,26],[43,108,41,5,"VISITED_ROUTE_KEYS"],[43,126,39,26],[43,128,41,26,"visitedRouteKeys"],[43,144,39,26],[43,146,39,2],[45,0,44,2],[45,57,44,22,"removedRoutes"],[45,70,44,2],[45,110,44,37],[46,0,44,37],[48,0,44,37],[48,10,44,13,"route"],[48,15,44,37],[50,0,45,4],[50,10,45,8,"visitedRouteKeys"],[50,26,45,24],[50,27,45,25,"has"],[50,30,45,8],[50,31,45,29,"route"],[50,36,45,34],[50,37,45,35,"key"],[50,40,45,8],[50,41,45,4],[50,43,45,41],[51,0,47,6],[52,0,48,5],[54,0,51,4],[54,10,51,10,"isPrevented"],[54,21,51,21],[54,49,51,24,"beforeRemoveListeners"],[54,70,51,45],[54,71,51,46,"route"],[54,76,51,51],[54,77,51,52,"key"],[54,80,51,45],[54,81,51,21],[54,102,51,24],[54,129,51,24,"beforeRemoveListeners"],[54,150,51,45],[54,152,51,59,"beforeRemoveAction"],[54,170,51,45],[54,171,51,4],[56,0,53,4],[56,10,53,8,"isPrevented"],[56,21,53,4],[56,23,53,21],[57,0,54,6],[57,15,54,13],[57,19,54,6],[58,0,55,5],[60,0,57,4,"visitedRouteKeys"],[60,6,57,4,"visitedRouteKeys"],[60,22,57,20],[60,23,57,21,"add"],[60,26,57,4],[60,27,57,25,"route"],[60,32,57,30],[60,33,57,31,"key"],[60,36,57,4],[61,0,59,4],[61,10,59,10,"event"],[61,15,59,15],[61,18,59,18,"emitter"],[61,25,59,25],[61,26,59,26,"emit"],[61,30,59,18],[61,31,59,31],[62,0,60,6,"type"],[62,8,60,6,"type"],[62,12,60,10],[62,14,60,12],[62,28,59,31],[63,0,61,6,"target"],[63,8,61,6,"target"],[63,14,61,12],[63,16,61,14,"route"],[63,21,61,19],[63,22,61,20,"key"],[63,25,59,31],[64,0,62,6,"data"],[64,8,62,6,"data"],[64,12,62,10],[64,14,62,12],[65,0,62,14,"action"],[65,10,62,14,"action"],[65,16,62,20],[65,18,62,22,"beforeRemoveAction"],[66,0,62,12],[66,9,59,31],[67,0,63,6,"canPreventDefault"],[67,8,63,6,"canPreventDefault"],[67,25,63,23],[67,27,63,25],[68,0,59,31],[68,7,59,18],[68,8,59,4],[70,0,66,4],[70,10,66,8,"event"],[70,15,66,13],[70,16,66,14,"defaultPrevented"],[70,32,66,4],[70,34,66,32],[71,0,67,6],[71,15,67,13],[71,19,67,6],[72,0,68,5],[73,0,69,3],[75,0,71,2],[75,11,71,9],[75,16,71,2],[76,0,72,1],[76,3,21,7],[80,0,74,15],[80,11,74,24,"useOnPreventRemove"],[80,29,74,15],[80,36,78,12],[81,0,78,12],[81,8,75,2,"getState"],[81,16,78,12],[81,24,75,2,"getState"],[81,32,78,12],[82,0,78,12],[82,8,76,2,"emitter"],[82,15,78,12],[82,23,76,2,"emitter"],[82,30,78,12],[83,0,78,12],[83,8,77,2,"beforeRemoveListeners"],[83,29,78,12],[83,37,77,2,"beforeRemoveListeners"],[83,58,78,12],[85,0,78,12],[85,28,79,31,"React"],[85,33,79,36],[85,34,79,37,"useContext"],[85,44,79,31],[85,45,79,48,"NavigationBuilderContext"],[85,78,79,31],[85,79,78,12],[86,0,78,12],[86,8,79,10,"addKeyedListener"],[86,24,78,12],[86,45,79,10,"addKeyedListener"],[86,61,78,12],[88,0,80,2],[88,8,80,8,"route"],[88,13,80,13],[88,16,80,16,"React"],[88,21,80,21],[88,22,80,22,"useContext"],[88,32,80,16],[88,33,80,33,"NavigationRouteContext"],[88,64,80,16],[88,65,80,2],[89,0,81,2],[89,8,81,8,"routeKey"],[89,16,81,16],[89,19,81,19,"route"],[89,24,81,16],[89,44,81,19,"route"],[89,49,81,24],[89,50,81,26,"key"],[89,53,81,2],[90,0,83,2,"React"],[90,4,83,2,"React"],[90,9,83,7],[90,10,83,8,"useEffect"],[90,19,83,2],[90,20,83,18],[90,32,83,24],[91,0,84,4],[91,10,84,8,"routeKey"],[91,18,84,4],[91,20,84,18],[92,0,85,6],[92,15,85,13,"addKeyedListener"],[92,31,85,6],[92,51,85,13,"addKeyedListener"],[92,67,85,29],[92,68,85,32],[92,82,85,29],[92,84,85,48,"routeKey"],[92,92,85,29],[92,94,85,58],[92,104,85,59,"action"],[92,110,85,58],[92,112,85,70],[93,0,86,8],[93,14,86,14,"state"],[93,19,86,19],[93,22,86,22,"getState"],[93,30,86,30],[93,32,86,8],[94,0,88,8],[94,17,88,15,"shouldPreventRemove"],[94,36,88,34],[94,37,89,10,"emitter"],[94,44,88,34],[94,46,90,10,"beforeRemoveListeners"],[94,67,88,34],[94,69,91,10,"state"],[94,74,91,15],[94,75,91,16,"routes"],[94,81,88,34],[94,83,92,10],[94,85,88,34],[94,87,93,10,"action"],[94,93,88,34],[94,94,88,8],[95,0,95,7],[95,9,85,29],[95,10,85,6],[96,0,96,5],[97,0,97,3],[97,5,83,2],[97,7,97,5],[97,8,97,6,"addKeyedListener"],[97,24,97,5],[97,26,97,24,"beforeRemoveListeners"],[97,47,97,5],[97,49,97,47,"emitter"],[97,56,97,5],[97,58,97,56,"getState"],[97,66,97,5],[97,68,97,66,"routeKey"],[97,76,97,5],[97,77,83,2],[98,0,98,1]],"functionMap":{"names":["<global>","shouldPreventRemove","nextRoutes.map$argument_0","currentRoutes.filter$argument_0","useOnPreventRemove","React.useEffect$argument_0","<anonymous>"],"mappings":"AAA;mCCoB;uCCO,oBD;YEI,6CF;CDwC;eIE;kBCS;0DCE;ODU;GDE;CJC"}},"type":"js/module"}]}