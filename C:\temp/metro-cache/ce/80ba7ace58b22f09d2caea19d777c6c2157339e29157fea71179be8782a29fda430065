{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireWildcard","data":{"isAsync":false}},{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"isAsync":false}},{"name":"@babel/runtime/helpers/defineProperty","data":{"isAsync":false}},{"name":"@babel/runtime/helpers/toConsumableArray","data":{"isAsync":false}},{"name":"react","data":{"isAsync":false}},{"name":"./NavigationBuilderContext","data":{"isAsync":false}},{"name":"./NavigationRouteContext","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireWildcard = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireWildcard\");\n\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/helpers/interopRequireDefault\");\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = useOnPreventRemove;\n  exports.shouldPreventRemove = void 0;\n\n  var _defineProperty2 = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[2], \"@babel/runtime/helpers/defineProperty\"));\n\n  var _toConsumableArray2 = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[3], \"@babel/runtime/helpers/toConsumableArray\"));\n\n  var React = _interopRequireWildcard(_$$_REQUIRE(_dependencyMap[4], \"react\"));\n\n  var _NavigationBuilderContext = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[5], \"./NavigationBuilderContext\"));\n\n  var _NavigationRouteContext = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[6], \"./NavigationRouteContext\"));\n\n  function _createForOfIteratorHelperLoose(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } it = o[Symbol.iterator](); return it.next.bind(it); }\n\n  function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\n  function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n  function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\n  function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n  var VISITED_ROUTE_KEYS = Symbol('VISITED_ROUTE_KEYS');\n\n  var shouldPreventRemove = function shouldPreventRemove(emitter, beforeRemoveListeners, routes, action) {\n    var _action$VISITED_ROUTE;\n\n    var reversedRoutes = (0, _toConsumableArray2.default)(routes).reverse();\n    var visitedRouteKeys = (_action$VISITED_ROUTE = action[VISITED_ROUTE_KEYS]) != null ? _action$VISITED_ROUTE : new Set();\n\n    var beforeRemoveAction = _objectSpread(_objectSpread({}, action), {}, (0, _defineProperty2.default)({}, VISITED_ROUTE_KEYS, visitedRouteKeys));\n\n    for (var _iterator = _createForOfIteratorHelperLoose(reversedRoutes), _step; !(_step = _iterator()).done;) {\n      var _beforeRemoveListener;\n\n      var route = _step.value;\n\n      if (visitedRouteKeys.has(route.key)) {\n        continue;\n      }\n\n      var isPrevented = (_beforeRemoveListener = beforeRemoveListeners[route.key]) == null ? void 0 : _beforeRemoveListener.call(beforeRemoveListeners, beforeRemoveAction);\n\n      if (isPrevented) {\n        return true;\n      }\n\n      visitedRouteKeys.add(route.key);\n      var event = emitter.emit({\n        type: 'beforeRemove',\n        target: route.key,\n        data: {\n          action: beforeRemoveAction\n        },\n        canPreventDefault: true\n      });\n\n      if (event.defaultPrevented) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  exports.shouldPreventRemove = shouldPreventRemove;\n\n  function useOnPreventRemove(_ref) {\n    var getState = _ref.getState,\n        emitter = _ref.emitter,\n        beforeRemoveListeners = _ref.beforeRemoveListeners;\n\n    var _React$useContext = React.useContext(_NavigationBuilderContext.default),\n        addKeyedListener = _React$useContext.addKeyedListener;\n\n    var route = React.useContext(_NavigationRouteContext.default);\n    var routeKey = route == null ? void 0 : route.key;\n    React.useEffect(function () {\n      if (routeKey) {\n        return addKeyedListener == null ? void 0 : addKeyedListener('beforeRemove', routeKey, function (action) {\n          var state = getState();\n          return shouldPreventRemove(emitter, beforeRemoveListeners, state.routes, action);\n        });\n      }\n    }, [addKeyedListener, beforeRemoveListeners, emitter, getState, routeKey]);\n  }\n});","lineCount":96,"map":[[16,0,1,0],[18,0,7,0],[20,0,10,0],[32,0,20,0],[32,6,20,6,"VISITED_ROUTE_KEYS"],[32,24,20,24],[32,27,20,27,"Symbol"],[32,33,20,33],[32,34,20,34],[32,54,20,33],[32,55,20,0],[34,0,22,7],[34,6,22,13,"shouldPreventRemove"],[34,25,22,32],[34,28,22,35],[34,37,22,13,"shouldPreventRemove"],[34,56,22,35],[34,57,23,2,"emitter"],[34,64,22,35],[34,66,24,2,"beforeRemoveListeners"],[34,87,22,35],[34,89,25,2,"routes"],[34,95,22,35],[34,97,26,2,"action"],[34,103,22,35],[34,105,27,5],[35,0,27,5],[37,0,29,2],[37,8,29,8,"reversedRoutes"],[37,22,29,22],[37,25,29,25],[37,58,29,29,"routes"],[37,64,29,25],[37,66,29,37,"reverse"],[37,73,29,25],[37,75,29,2],[38,0,31,2],[38,8,31,8,"visitedRouteKeys"],[38,24,31,37],[38,52,33,4,"action"],[38,58,33,10],[38,59,33,11,"VISITED_ROUTE_KEYS"],[38,77,33,10],[38,78,31,37],[38,114,33,34],[38,118,33,38,"Set"],[38,121,33,34],[38,123,31,2],[40,0,35,2],[40,8,35,8,"beforeRemoveAction"],[40,26,35,26],[40,61,36,7,"action"],[40,67,35,26],[40,108,37,5,"VISITED_ROUTE_KEYS"],[40,126,35,26],[40,128,37,26,"visitedRouteKeys"],[40,144,35,26],[40,146,35,2],[42,0,40,2],[42,57,40,22,"reversedRoutes"],[42,71,40,2],[42,111,40,38],[43,0,40,38],[45,0,40,38],[45,10,40,13,"route"],[45,15,40,38],[47,0,41,4],[47,10,41,8,"visitedRouteKeys"],[47,26,41,24],[47,27,41,25,"has"],[47,30,41,8],[47,31,41,29,"route"],[47,36,41,34],[47,37,41,35,"key"],[47,40,41,8],[47,41,41,4],[47,43,41,41],[48,0,43,6],[49,0,44,5],[51,0,47,4],[51,10,47,10,"isPrevented"],[51,21,47,21],[51,49,47,24,"beforeRemoveListeners"],[51,70,47,45],[51,71,47,46,"route"],[51,76,47,51],[51,77,47,52,"key"],[51,80,47,45],[51,81,47,21],[51,102,47,24],[51,129,47,24,"beforeRemoveListeners"],[51,150,47,45],[51,152,47,59,"beforeRemoveAction"],[51,170,47,45],[51,171,47,4],[53,0,49,4],[53,10,49,8,"isPrevented"],[53,21,49,4],[53,23,49,21],[54,0,50,6],[54,15,50,13],[54,19,50,6],[55,0,51,5],[57,0,53,4,"visitedRouteKeys"],[57,6,53,4,"visitedRouteKeys"],[57,22,53,20],[57,23,53,21,"add"],[57,26,53,4],[57,27,53,25,"route"],[57,32,53,30],[57,33,53,31,"key"],[57,36,53,4],[58,0,55,4],[58,10,55,10,"event"],[58,15,55,15],[58,18,55,18,"emitter"],[58,25,55,25],[58,26,55,26,"emit"],[58,30,55,18],[58,31,55,31],[59,0,56,6,"type"],[59,8,56,6,"type"],[59,12,56,10],[59,14,56,12],[59,28,55,31],[60,0,57,6,"target"],[60,8,57,6,"target"],[60,14,57,12],[60,16,57,14,"route"],[60,21,57,19],[60,22,57,20,"key"],[60,25,55,31],[61,0,58,6,"data"],[61,8,58,6,"data"],[61,12,58,10],[61,14,58,12],[62,0,58,14,"action"],[62,10,58,14,"action"],[62,16,58,20],[62,18,58,22,"beforeRemoveAction"],[63,0,58,12],[63,9,55,31],[64,0,59,6,"canPreventDefault"],[64,8,59,6,"canPreventDefault"],[64,25,59,23],[64,27,59,25],[65,0,55,31],[65,7,55,18],[65,8,55,4],[67,0,62,4],[67,10,62,8,"event"],[67,15,62,13],[67,16,62,14,"defaultPrevented"],[67,32,62,4],[67,34,62,32],[68,0,63,6],[68,15,63,13],[68,19,63,6],[69,0,64,5],[70,0,65,3],[72,0,67,2],[72,11,67,9],[72,16,67,2],[73,0,68,1],[73,3,22,7],[77,0,70,15],[77,11,70,24,"useOnPreventRemove"],[77,29,70,15],[77,36,74,12],[78,0,74,12],[78,8,71,2,"getState"],[78,16,74,12],[78,24,71,2,"getState"],[78,32,74,12],[79,0,74,12],[79,8,72,2,"emitter"],[79,15,74,12],[79,23,72,2,"emitter"],[79,30,74,12],[80,0,74,12],[80,8,73,2,"beforeRemoveListeners"],[80,29,74,12],[80,37,73,2,"beforeRemoveListeners"],[80,58,74,12],[82,0,74,12],[82,28,75,31,"React"],[82,33,75,36],[82,34,75,37,"useContext"],[82,44,75,31],[82,45,75,48,"NavigationBuilderContext"],[82,78,75,31],[82,79,74,12],[83,0,74,12],[83,8,75,10,"addKeyedListener"],[83,24,74,12],[83,45,75,10,"addKeyedListener"],[83,61,74,12],[85,0,76,2],[85,8,76,8,"route"],[85,13,76,13],[85,16,76,16,"React"],[85,21,76,21],[85,22,76,22,"useContext"],[85,32,76,16],[85,33,76,33,"NavigationRouteContext"],[85,64,76,16],[85,65,76,2],[86,0,77,2],[86,8,77,8,"routeKey"],[86,16,77,16],[86,19,77,19,"route"],[86,24,77,16],[86,44,77,19,"route"],[86,49,77,24],[86,50,77,26,"key"],[86,53,77,2],[87,0,79,2,"React"],[87,4,79,2,"React"],[87,9,79,7],[87,10,79,8,"useEffect"],[87,19,79,2],[87,20,79,18],[87,32,79,24],[88,0,80,4],[88,10,80,8,"routeKey"],[88,18,80,4],[88,20,80,18],[89,0,81,6],[89,15,81,13,"addKeyedListener"],[89,31,81,6],[89,51,81,13,"addKeyedListener"],[89,67,81,29],[89,68,81,32],[89,82,81,29],[89,84,81,48,"routeKey"],[89,92,81,29],[89,94,81,58],[89,104,81,59,"action"],[89,110,81,58],[89,112,81,70],[90,0,82,8],[90,14,82,14,"state"],[90,19,82,19],[90,22,82,22,"getState"],[90,30,82,30],[90,32,82,8],[91,0,84,8],[91,17,84,15,"shouldPreventRemove"],[91,36,84,34],[91,37,85,10,"emitter"],[91,44,84,34],[91,46,86,10,"beforeRemoveListeners"],[91,67,84,34],[91,69,87,10,"state"],[91,74,87,15],[91,75,87,16,"routes"],[91,81,84,34],[91,83,88,10,"action"],[91,89,84,34],[91,90,84,8],[92,0,90,7],[92,9,81,29],[92,10,81,6],[93,0,91,5],[94,0,92,3],[94,5,79,2],[94,7,92,5],[94,8,92,6,"addKeyedListener"],[94,24,92,5],[94,26,92,24,"beforeRemoveListeners"],[94,47,92,5],[94,49,92,47,"emitter"],[94,56,92,5],[94,58,92,56,"getState"],[94,66,92,5],[94,68,92,66,"routeKey"],[94,76,92,5],[94,77,79,2],[95,0,93,1]],"functionMap":{"names":["<global>","shouldPreventRemove","useOnPreventRemove","React.useEffect$argument_0","<anonymous>"],"mappings":"AAA;mCCqB;CD8C;eEE;kBCS;0DCE;ODS;GDE;CFC"}},"type":"js/module"}]}