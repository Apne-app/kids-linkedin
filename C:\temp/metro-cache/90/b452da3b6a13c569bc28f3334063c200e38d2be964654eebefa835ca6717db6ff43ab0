{"dependencies":[{"name":"../util/class","data":{"isAsync":false,"locs":[{"start":{"line":3,"column":16},"end":{"line":3,"column":40}}]}},{"name":"../util/uri","data":{"isAsync":false,"locs":[{"start":{"line":4,"column":16},"end":{"line":4,"column":38}}]}},{"name":"../util/browser","data":{"isAsync":false,"locs":[{"start":{"line":5,"column":16},"end":{"line":5,"column":42}}]}},{"name":"../util/assign","data":{"isAsync":false,"locs":[{"start":{"line":6,"column":16},"end":{"line":6,"column":41}}]}},{"name":"../util/to_json","data":{"isAsync":false,"locs":[{"start":{"line":7,"column":16},"end":{"line":7,"column":42}}]}},{"name":"./transport","data":{"isAsync":false,"locs":[{"start":{"line":8,"column":16},"end":{"line":8,"column":38}}]}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  var Class = _$$_REQUIRE(_dependencyMap[0], \"../util/class\"),\n      URI = _$$_REQUIRE(_dependencyMap[1], \"../util/uri\"),\n      browser = _$$_REQUIRE(_dependencyMap[2], \"../util/browser\"),\n      assign = _$$_REQUIRE(_dependencyMap[3], \"../util/assign\"),\n      toJSON = _$$_REQUIRE(_dependencyMap[4], \"../util/to_json\"),\n      Transport = _$$_REQUIRE(_dependencyMap[5], \"./transport\");\n\n  var XHR = assign(Class(Transport, {\n    encode: function encode(messages) {\n      return toJSON(messages);\n    },\n    request: function request(messages) {\n      var href = this.endpoint.href,\n          self = this,\n          xhr;\n\n      if (global.XMLHttpRequest) {\n        xhr = new XMLHttpRequest();\n      } else if (global.ActiveXObject) {\n        xhr = new ActiveXObject('Microsoft.XMLHTTP');\n      } else {\n        return this._handleError(messages);\n      }\n\n      xhr.open('POST', href, true);\n      xhr.setRequestHeader('Content-Type', 'application/json');\n      xhr.setRequestHeader('Pragma', 'no-cache');\n      xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n      var headers = this._dispatcher.headers;\n\n      for (var key in headers) {\n        if (!headers.hasOwnProperty(key)) continue;\n        xhr.setRequestHeader(key, headers[key]);\n      }\n\n      var abort = function abort() {\n        xhr.abort();\n      };\n\n      if (global.onbeforeunload !== undefined) browser.Event.on(global, 'beforeunload', abort);\n\n      xhr.onreadystatechange = function () {\n        if (!xhr || xhr.readyState !== 4) return;\n        var replies = null,\n            status = xhr.status,\n            text = xhr.responseText,\n            successful = status >= 200 && status < 300 || status === 304 || status === 1223;\n        if (global.onbeforeunload !== undefined) browser.Event.detach(global, 'beforeunload', abort);\n\n        xhr.onreadystatechange = function () {};\n\n        xhr = null;\n        if (!successful) return self._handleError(messages);\n\n        try {\n          replies = JSON.parse(text);\n        } catch (error) {}\n\n        if (replies) self._receive(replies);else self._handleError(messages);\n      };\n\n      xhr.send(this.encode(messages));\n      return xhr;\n    }\n  }), {\n    isUsable: function isUsable(dispatcher, endpoint, callback, context) {\n      var usable = navigator.product === 'ReactNative' || URI.isSameOrigin(endpoint);\n      callback.call(context, usable);\n    }\n  });\n  module.exports = XHR;\n});","lineCount":75,"map":[[2,0,1,0],[4,0,3,0],[4,6,3,4,"Class"],[4,11,3,9],[4,14,3,16,"require"],[4,25,3,23],[4,61,3,0],[5,0,3,0],[5,6,4,4,"URI"],[5,9,4,7],[5,12,4,16,"require"],[5,23,4,23],[5,57,3,0],[6,0,3,0],[6,6,5,4,"browser"],[6,13,5,11],[6,16,5,16,"require"],[6,27,5,23],[6,65,3,0],[7,0,3,0],[7,6,6,4,"assign"],[7,12,6,10],[7,15,6,16,"require"],[7,26,6,23],[7,63,3,0],[8,0,3,0],[8,6,7,4,"toJSON"],[8,12,7,10],[8,15,7,16,"require"],[8,26,7,23],[8,64,3,0],[9,0,3,0],[9,6,8,4,"Transport"],[9,15,8,13],[9,18,8,16,"require"],[9,29,8,23],[9,63,3,0],[11,0,10,0],[11,6,10,4,"XHR"],[11,9,10,7],[11,12,10,10,"assign"],[11,18,10,16],[11,19,10,17,"Class"],[11,24,10,22],[11,25,10,23,"Transport"],[11,34,10,22],[11,36,10,34],[12,0,11,2,"encode"],[12,4,11,2,"encode"],[12,10,11,8],[12,12,11,10],[12,28,11,19,"messages"],[12,36,11,10],[12,38,11,29],[13,0,12,4],[13,13,12,11,"toJSON"],[13,19,12,17],[13,20,12,18,"messages"],[13,28,12,17],[13,29,12,4],[14,0,13,3],[14,5,10,34],[15,0,15,2,"request"],[15,4,15,2,"request"],[15,11,15,9],[15,13,15,11],[15,30,15,20,"messages"],[15,38,15,11],[15,40,15,30],[16,0,16,4],[16,10,16,8,"href"],[16,14,16,12],[16,17,16,15],[16,22,16,20,"endpoint"],[16,30,16,15],[16,31,16,29,"href"],[16,35,16,4],[17,0,16,4],[17,10,17,8,"self"],[17,14,17,12],[17,17,17,15],[17,21,16,4],[18,0,16,4],[18,10,18,8,"xhr"],[18,13,16,4],[20,0,21,4],[20,10,21,8,"global"],[20,16,21,14],[20,17,21,15,"XMLHttpRequest"],[20,31,21,4],[20,33,21,31],[21,0,22,6,"xhr"],[21,8,22,6,"xhr"],[21,11,22,9],[21,14,22,12],[21,18,22,16,"XMLHttpRequest"],[21,32,22,12],[21,34,22,6],[22,0,23,5],[22,7,21,4],[22,13,23,11],[22,17,23,15,"global"],[22,23,23,21],[22,24,23,22,"ActiveXObject"],[22,37,23,11],[22,39,23,37],[23,0,24,6,"xhr"],[23,8,24,6,"xhr"],[23,11,24,9],[23,14,24,12],[23,18,24,16,"ActiveXObject"],[23,31,24,12],[23,32,24,30],[23,51,24,12],[23,52,24,6],[24,0,25,5],[24,7,23,11],[24,13,25,11],[25,0,26,6],[25,15,26,13],[25,20,26,18,"_handleError"],[25,32,26,13],[25,33,26,31,"messages"],[25,41,26,13],[25,42,26,6],[26,0,27,5],[28,0,29,4,"xhr"],[28,6,29,4,"xhr"],[28,9,29,7],[28,10,29,8,"open"],[28,14,29,4],[28,15,29,13],[28,21,29,4],[28,23,29,21,"href"],[28,27,29,4],[28,29,29,27],[28,33,29,4],[29,0,30,4,"xhr"],[29,6,30,4,"xhr"],[29,9,30,7],[29,10,30,8,"setRequestHeader"],[29,26,30,4],[29,27,30,25],[29,41,30,4],[29,43,30,41],[29,61,30,4],[30,0,31,4,"xhr"],[30,6,31,4,"xhr"],[30,9,31,7],[30,10,31,8,"setRequestHeader"],[30,26,31,4],[30,27,31,25],[30,35,31,4],[30,37,31,35],[30,47,31,4],[31,0,32,4,"xhr"],[31,6,32,4,"xhr"],[31,9,32,7],[31,10,32,8,"setRequestHeader"],[31,26,32,4],[31,27,32,25],[31,45,32,4],[31,47,32,45],[31,63,32,4],[32,0,34,4],[32,10,34,8,"headers"],[32,17,34,15],[32,20,34,18],[32,25,34,23,"_dispatcher"],[32,36,34,18],[32,37,34,35,"headers"],[32,44,34,4],[34,0,35,4],[34,11,35,9],[34,15,35,13,"key"],[34,18,35,4],[34,22,35,20,"headers"],[34,29,35,4],[34,31,35,29],[35,0,36,6],[35,12,36,10],[35,13,36,11,"headers"],[35,20,36,18],[35,21,36,19,"hasOwnProperty"],[35,35,36,11],[35,36,36,34,"key"],[35,39,36,11],[35,40,36,6],[35,42,36,40],[36,0,37,6,"xhr"],[36,8,37,6,"xhr"],[36,11,37,9],[36,12,37,10,"setRequestHeader"],[36,28,37,6],[36,29,37,27,"key"],[36,32,37,6],[36,34,37,32,"headers"],[36,41,37,39],[36,42,37,40,"key"],[36,45,37,39],[36,46,37,6],[37,0,38,5],[39,0,40,4],[39,10,40,8,"abort"],[39,15,40,13],[39,18,40,16],[39,27,40,8,"abort"],[39,32,40,16],[39,35,40,27],[40,0,40,29,"xhr"],[40,8,40,29,"xhr"],[40,11,40,32],[40,12,40,33,"abort"],[40,17,40,29],[41,0,40,42],[41,7,40,4],[43,0,41,4],[43,10,41,8,"global"],[43,16,41,14],[43,17,41,15,"onbeforeunload"],[43,31,41,8],[43,36,41,34,"undefined"],[43,45,41,4],[43,47,42,6,"browser"],[43,54,42,13],[43,55,42,14,"Event"],[43,60,42,6],[43,61,42,20,"on"],[43,63,42,6],[43,64,42,23,"global"],[43,70,42,6],[43,72,42,31],[43,86,42,6],[43,88,42,47,"abort"],[43,93,42,6],[45,0,44,4,"xhr"],[45,6,44,4,"xhr"],[45,9,44,7],[45,10,44,8,"onreadystatechange"],[45,28,44,4],[45,31,44,29],[45,43,44,40],[46,0,45,6],[46,12,45,10],[46,13,45,11,"xhr"],[46,16,45,10],[46,20,45,18,"xhr"],[46,23,45,21],[46,24,45,22,"readyState"],[46,34,45,18],[46,39,45,37],[46,40,45,6],[46,42,45,40],[47,0,47,6],[47,12,47,10,"replies"],[47,19,47,17],[47,22,47,23],[47,26,47,6],[48,0,47,6],[48,12,48,10,"status"],[48,18,48,16],[48,21,48,23,"xhr"],[48,24,48,26],[48,25,48,27,"status"],[48,31,47,6],[49,0,47,6],[49,12,49,10,"text"],[49,16,49,14],[49,19,49,23,"xhr"],[49,22,49,26],[49,23,49,27,"responseText"],[49,35,47,6],[50,0,47,6],[50,12,50,10,"successful"],[50,22,50,20],[50,25,50,24,"status"],[50,31,50,30],[50,35,50,34],[50,38,50,24],[50,42,50,41,"status"],[50,48,50,47],[50,51,50,50],[50,54,50,23],[50,58,50,58,"status"],[50,64,50,64],[50,69,50,69],[50,72,50,23],[50,76,50,76,"status"],[50,82,50,82],[50,87,50,87],[50,91,47,6],[51,0,52,6],[51,12,52,10,"global"],[51,18,52,16],[51,19,52,17,"onbeforeunload"],[51,33,52,10],[51,38,52,36,"undefined"],[51,47,52,6],[51,49,53,8,"browser"],[51,56,53,15],[51,57,53,16,"Event"],[51,62,53,8],[51,63,53,22,"detach"],[51,69,53,8],[51,70,53,29,"global"],[51,76,53,8],[51,78,53,37],[51,92,53,8],[51,94,53,53,"abort"],[51,99,53,8],[53,0,55,6,"xhr"],[53,8,55,6,"xhr"],[53,11,55,9],[53,12,55,10,"onreadystatechange"],[53,30,55,6],[53,33,55,31],[53,45,55,42],[53,46,55,44],[53,47,55,6],[55,0,56,6,"xhr"],[55,8,56,6,"xhr"],[55,11,56,9],[55,14,56,12],[55,18,56,6],[56,0,58,6],[56,12,58,10],[56,13,58,11,"successful"],[56,23,58,6],[56,25,58,23],[56,32,58,30,"self"],[56,36,58,34],[56,37,58,35,"_handleError"],[56,49,58,30],[56,50,58,48,"messages"],[56,58,58,30],[56,59,58,23],[58,0,60,6],[58,12,60,10],[59,0,61,8,"replies"],[59,10,61,8,"replies"],[59,17,61,15],[59,20,61,18,"JSON"],[59,24,61,22],[59,25,61,23,"parse"],[59,30,61,18],[59,31,61,29,"text"],[59,35,61,18],[59,36,61,8],[60,0,62,7],[60,9,60,6],[60,10,62,8],[60,17,62,15,"error"],[60,22,62,8],[60,24,62,22],[60,25,62,24],[62,0,64,6],[62,12,64,10,"replies"],[62,19,64,6],[62,21,65,8,"self"],[62,25,65,12],[62,26,65,13,"_receive"],[62,34,65,8],[62,35,65,22,"replies"],[62,42,65,8],[62,44,64,6],[62,49,67,8,"self"],[62,53,67,12],[62,54,67,13,"_handleError"],[62,66,67,8],[62,67,67,26,"messages"],[62,75,67,8],[63,0,68,5],[63,7,44,4],[65,0,70,4,"xhr"],[65,6,70,4,"xhr"],[65,9,70,7],[65,10,70,8,"send"],[65,14,70,4],[65,15,70,13],[65,20,70,18,"encode"],[65,26,70,13],[65,27,70,25,"messages"],[65,35,70,13],[65,36,70,4],[66,0,71,4],[66,13,71,11,"xhr"],[66,16,71,4],[67,0,72,3],[68,0,10,34],[68,3,10,22],[68,4,10,16],[68,6,73,4],[69,0,74,2,"isUsable"],[69,4,74,2,"isUsable"],[69,12,74,10],[69,14,74,12],[69,32,74,21,"dispatcher"],[69,42,74,12],[69,44,74,33,"endpoint"],[69,52,74,12],[69,54,74,43,"callback"],[69,62,74,12],[69,64,74,53,"context"],[69,71,74,12],[69,73,74,62],[70,0,75,4],[70,10,75,8,"usable"],[70,16,75,14],[70,19,75,18,"navigator"],[70,28,75,27],[70,29,75,28,"product"],[70,36,75,18],[70,41,75,40],[70,54,75,17],[70,58,76,17,"URI"],[70,61,76,20],[70,62,76,21,"isSameOrigin"],[70,74,76,17],[70,75,76,34,"endpoint"],[70,83,76,17],[70,84,75,4],[71,0,78,4,"callback"],[71,6,78,4,"callback"],[71,14,78,12],[71,15,78,13,"call"],[71,19,78,4],[71,20,78,18,"context"],[71,27,78,4],[71,29,78,27,"usable"],[71,35,78,4],[72,0,79,3],[73,0,73,4],[73,3,10,16],[73,4,10,0],[74,0,82,0,"module"],[74,2,82,0,"module"],[74,8,82,6],[74,9,82,7,"exports"],[74,16,82,0],[74,19,82,17,"XHR"],[74,22,82,0]],"functionMap":{"names":["<global>","Class$argument_1.encode","Class$argument_1.request","abort","onreadystatechange","assign$argument_1.isUsable"],"mappings":"AAA;UCU;GDE;WEE;gBCyB,0BD;6BEI;KFwB;GFI;YKE;GLK"}},"type":"js/module"}]}