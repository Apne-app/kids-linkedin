{"dependencies":[{"name":"./globals","data":{"isAsync":false}},{"name":"./constants","data":{"isAsync":false}},{"name":"./attach-listener","data":{"isAsync":false}},{"name":"./attach-shared-listeners","data":{"isAsync":false}},{"name":"./manage-subscribers","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  var globals_1 = _$$_REQUIRE(_dependencyMap[0], \"./globals\");\n\n  var constants_1 = _$$_REQUIRE(_dependencyMap[1], \"./constants\");\n\n  var attach_listener_1 = _$$_REQUIRE(_dependencyMap[2], \"./attach-listener\");\n\n  var attach_shared_listeners_1 = _$$_REQUIRE(_dependencyMap[3], \"./attach-shared-listeners\");\n\n  var manage_subscribers_1 = _$$_REQUIRE(_dependencyMap[4], \"./manage-subscribers\");\n\n  exports.createOrJoinSocket = function (webSocketRef, url, setReadyState, optionsRef, setLastMessage, startRef, reconnectCount) {\n    if (optionsRef.current.share) {\n      if (globals_1.sharedWebSockets[url] === undefined) {\n        setReadyState(constants_1.ReadyState.CONNECTING);\n        globals_1.sharedWebSockets[url] = new WebSocket(url, optionsRef.current.protocols);\n        attach_shared_listeners_1.attachSharedListeners(globals_1.sharedWebSockets[url], url);\n      } else {\n        setReadyState(globals_1.sharedWebSockets[url].readyState);\n      }\n\n      var subscriber_1 = {\n        setLastMessage: setLastMessage,\n        setReadyState: setReadyState,\n        optionsRef: optionsRef,\n        reconnectCount: reconnectCount,\n        reconnect: startRef\n      };\n      manage_subscribers_1.addSubscriber(url, subscriber_1);\n      webSocketRef.current = globals_1.sharedWebSockets[url];\n      return function () {\n        manage_subscribers_1.removeSubscriber(url, subscriber_1);\n\n        if (!manage_subscribers_1.hasSubscribers(url)) {\n          try {\n            globals_1.sharedWebSockets[url].onclose = function (event) {\n              if (optionsRef.current.onClose) {\n                optionsRef.current.onClose(event);\n              }\n\n              setReadyState(constants_1.ReadyState.CLOSED);\n            };\n\n            globals_1.sharedWebSockets[url].close();\n          } catch (e) {}\n\n          delete globals_1.sharedWebSockets[url];\n        }\n      };\n    } else {\n      setReadyState(constants_1.ReadyState.CONNECTING);\n      webSocketRef.current = new WebSocket(url, optionsRef.current.protocols);\n      return attach_listener_1.attachListeners(webSocketRef.current, {\n        setLastMessage: setLastMessage,\n        setReadyState: setReadyState\n      }, optionsRef, startRef.current, reconnectCount);\n    }\n  };\n});","lineCount":65,"map":[[2,0,1,0],[4,0,2,0,"Object"],[4,2,2,0,"Object"],[4,8,2,6],[4,9,2,7,"defineProperty"],[4,23,2,0],[4,24,2,22,"exports"],[4,31,2,0],[4,33,2,31],[4,45,2,0],[4,47,2,45],[5,0,2,47,"value"],[5,4,2,47,"value"],[5,9,2,52],[5,11,2,54],[6,0,2,45],[6,3,2,0],[8,0,3,0],[8,6,3,4,"globals_1"],[8,15,3,13],[8,18,3,16,"require"],[8,29,3,23],[8,61,3,0],[10,0,4,0],[10,6,4,4,"constants_1"],[10,17,4,15],[10,20,4,18,"require"],[10,31,4,25],[10,65,4,0],[12,0,5,0],[12,6,5,4,"attach_listener_1"],[12,23,5,21],[12,26,5,24,"require"],[12,37,5,31],[12,77,5,0],[14,0,6,0],[14,6,6,4,"attach_shared_listeners_1"],[14,31,6,29],[14,34,6,32,"require"],[14,45,6,39],[14,93,6,0],[16,0,7,0],[16,6,7,4,"manage_subscribers_1"],[16,26,7,24],[16,29,7,27,"require"],[16,40,7,34],[16,83,7,0],[18,0,8,0,"exports"],[18,2,8,0,"exports"],[18,9,8,7],[18,10,8,8,"createOrJoinSocket"],[18,28,8,0],[18,31,8,29],[18,41,8,39,"webSocketRef"],[18,53,8,29],[18,55,8,53,"url"],[18,58,8,29],[18,60,8,58,"setReadyState"],[18,73,8,29],[18,75,8,73,"optionsRef"],[18,85,8,29],[18,87,8,85,"setLastMessage"],[18,101,8,29],[18,103,8,101,"startRef"],[18,111,8,29],[18,113,8,111,"reconnectCount"],[18,127,8,29],[18,129,8,127],[19,0,9,4],[19,8,9,8,"optionsRef"],[19,18,9,18],[19,19,9,19,"current"],[19,26,9,8],[19,27,9,27,"share"],[19,32,9,4],[19,34,9,34],[20,0,10,8],[20,10,10,12,"globals_1"],[20,19,10,21],[20,20,10,22,"sharedWebSockets"],[20,36,10,12],[20,37,10,39,"url"],[20,40,10,12],[20,46,10,48,"undefined"],[20,55,10,8],[20,57,10,59],[21,0,11,12,"setReadyState"],[21,8,11,12,"setReadyState"],[21,21,11,25],[21,22,11,26,"constants_1"],[21,33,11,37],[21,34,11,38,"ReadyState"],[21,44,11,26],[21,45,11,49,"CONNECTING"],[21,55,11,25],[21,56,11,12],[22,0,12,12,"globals_1"],[22,8,12,12,"globals_1"],[22,17,12,21],[22,18,12,22,"sharedWebSockets"],[22,34,12,12],[22,35,12,39,"url"],[22,38,12,12],[22,42,12,46],[22,46,12,50,"WebSocket"],[22,55,12,46],[22,56,12,60,"url"],[22,59,12,46],[22,61,12,65,"optionsRef"],[22,71,12,75],[22,72,12,76,"current"],[22,79,12,65],[22,80,12,84,"protocols"],[22,89,12,46],[22,90,12,12],[23,0,13,12,"attach_shared_listeners_1"],[23,8,13,12,"attach_shared_listeners_1"],[23,33,13,37],[23,34,13,38,"attachSharedListeners"],[23,55,13,12],[23,56,13,60,"globals_1"],[23,65,13,69],[23,66,13,70,"sharedWebSockets"],[23,82,13,60],[23,83,13,87,"url"],[23,86,13,60],[23,87,13,12],[23,89,13,93,"url"],[23,92,13,12],[24,0,14,9],[24,7,10,8],[24,13,15,13],[25,0,16,12,"setReadyState"],[25,8,16,12,"setReadyState"],[25,21,16,25],[25,22,16,26,"globals_1"],[25,31,16,35],[25,32,16,36,"sharedWebSockets"],[25,48,16,26],[25,49,16,53,"url"],[25,52,16,26],[25,54,16,58,"readyState"],[25,64,16,25],[25,65,16,12],[26,0,17,9],[28,0,18,8],[28,10,18,12,"subscriber_1"],[28,22,18,24],[28,25,18,27],[29,0,19,12,"setLastMessage"],[29,8,19,12,"setLastMessage"],[29,22,19,26],[29,24,19,28,"setLastMessage"],[29,38,18,27],[30,0,20,12,"setReadyState"],[30,8,20,12,"setReadyState"],[30,21,20,25],[30,23,20,27,"setReadyState"],[30,36,18,27],[31,0,21,12,"optionsRef"],[31,8,21,12,"optionsRef"],[31,18,21,22],[31,20,21,24,"optionsRef"],[31,30,18,27],[32,0,22,12,"reconnectCount"],[32,8,22,12,"reconnectCount"],[32,22,22,26],[32,24,22,28,"reconnectCount"],[32,38,18,27],[33,0,23,12,"reconnect"],[33,8,23,12,"reconnect"],[33,17,23,21],[33,19,23,23,"startRef"],[34,0,18,27],[34,7,18,8],[35,0,25,8,"manage_subscribers_1"],[35,6,25,8,"manage_subscribers_1"],[35,26,25,28],[35,27,25,29,"addSubscriber"],[35,40,25,8],[35,41,25,43,"url"],[35,44,25,8],[35,46,25,48,"subscriber_1"],[35,58,25,8],[36,0,26,8,"webSocketRef"],[36,6,26,8,"webSocketRef"],[36,18,26,20],[36,19,26,21,"current"],[36,26,26,8],[36,29,26,31,"globals_1"],[36,38,26,40],[36,39,26,41,"sharedWebSockets"],[36,55,26,31],[36,56,26,58,"url"],[36,59,26,31],[36,60,26,8],[37,0,27,8],[37,13,27,15],[37,25,27,27],[38,0,28,12,"manage_subscribers_1"],[38,8,28,12,"manage_subscribers_1"],[38,28,28,32],[38,29,28,33,"removeSubscriber"],[38,45,28,12],[38,46,28,50,"url"],[38,49,28,12],[38,51,28,55,"subscriber_1"],[38,63,28,12],[40,0,29,12],[40,12,29,16],[40,13,29,17,"manage_subscribers_1"],[40,33,29,37],[40,34,29,38,"hasSubscribers"],[40,48,29,17],[40,49,29,53,"url"],[40,52,29,17],[40,53,29,12],[40,55,29,59],[41,0,30,16],[41,14,30,20],[42,0,31,20,"globals_1"],[42,12,31,20,"globals_1"],[42,21,31,29],[42,22,31,30,"sharedWebSockets"],[42,38,31,20],[42,39,31,47,"url"],[42,42,31,20],[42,44,31,52,"onclose"],[42,51,31,20],[42,54,31,62],[42,64,31,72,"event"],[42,69,31,62],[42,71,31,79],[43,0,32,24],[43,18,32,28,"optionsRef"],[43,28,32,38],[43,29,32,39,"current"],[43,36,32,28],[43,37,32,47,"onClose"],[43,44,32,24],[43,46,32,56],[44,0,33,28,"optionsRef"],[44,16,33,28,"optionsRef"],[44,26,33,38],[44,27,33,39,"current"],[44,34,33,28],[44,35,33,47,"onClose"],[44,42,33,28],[44,43,33,55,"event"],[44,48,33,28],[45,0,34,25],[47,0,35,24,"setReadyState"],[47,14,35,24,"setReadyState"],[47,27,35,37],[47,28,35,38,"constants_1"],[47,39,35,49],[47,40,35,50,"ReadyState"],[47,50,35,38],[47,51,35,61,"CLOSED"],[47,57,35,37],[47,58,35,24],[48,0,36,21],[48,13,31,20],[50,0,37,20,"globals_1"],[50,12,37,20,"globals_1"],[50,21,37,29],[50,22,37,30,"sharedWebSockets"],[50,38,37,20],[50,39,37,47,"url"],[50,42,37,20],[50,44,37,52,"close"],[50,49,37,20],[51,0,38,17],[51,11,30,16],[51,12,39,16],[51,19,39,23,"e"],[51,20,39,16],[51,22,39,26],[51,23,40,17],[53,0,41,16],[53,17,41,23,"globals_1"],[53,26,41,32],[53,27,41,33,"sharedWebSockets"],[53,43,41,23],[53,44,41,50,"url"],[53,47,41,23],[53,48,41,16],[54,0,42,13],[55,0,43,9],[55,7,27,8],[56,0,44,5],[56,5,9,4],[56,11,45,9],[57,0,46,8,"setReadyState"],[57,6,46,8,"setReadyState"],[57,19,46,21],[57,20,46,22,"constants_1"],[57,31,46,33],[57,32,46,34,"ReadyState"],[57,42,46,22],[57,43,46,45,"CONNECTING"],[57,53,46,21],[57,54,46,8],[58,0,47,8,"webSocketRef"],[58,6,47,8,"webSocketRef"],[58,18,47,20],[58,19,47,21,"current"],[58,26,47,8],[58,29,47,31],[58,33,47,35,"WebSocket"],[58,42,47,31],[58,43,47,45,"url"],[58,46,47,31],[58,48,47,50,"optionsRef"],[58,58,47,60],[58,59,47,61,"current"],[58,66,47,50],[58,67,47,69,"protocols"],[58,76,47,31],[58,77,47,8],[59,0,48,8],[59,13,48,15,"attach_listener_1"],[59,30,48,32],[59,31,48,33,"attachListeners"],[59,46,48,15],[59,47,48,49,"webSocketRef"],[59,59,48,61],[59,60,48,62,"current"],[59,67,48,15],[59,69,48,71],[60,0,49,12,"setLastMessage"],[60,8,49,12,"setLastMessage"],[60,22,49,26],[60,24,49,28,"setLastMessage"],[60,38,48,71],[61,0,50,12,"setReadyState"],[61,8,50,12,"setReadyState"],[61,21,50,25],[61,23,50,27,"setReadyState"],[62,0,48,71],[62,7,48,15],[62,9,51,11,"optionsRef"],[62,19,48,15],[62,21,51,23,"startRef"],[62,29,51,31],[62,30,51,32,"current"],[62,37,48,15],[62,39,51,41,"reconnectCount"],[62,53,48,15],[62,54,48,8],[63,0,52,5],[64,0,53,1],[64,3,8,0]],"functionMap":{"names":["<global>","exports.createOrJoinSocket","<anonymous>","globals_1.sharedWebSockets.url.onclose"],"mappings":"AAA;6BCO;eCmB;8DCI;qBDK;SDO;CDU"}},"type":"js/module"}]}