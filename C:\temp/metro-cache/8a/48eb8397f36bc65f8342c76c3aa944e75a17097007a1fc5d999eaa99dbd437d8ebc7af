{"dependencies":[{"name":"./globals","data":{"isAsync":false}},{"name":"./constants","data":{"isAsync":false}},{"name":"./attach-listener","data":{"isAsync":false}},{"name":"./attach-shared-listeners","data":{"isAsync":false}},{"name":"./manage-subscribers","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.createOrJoinSocket = void 0;\n\n  var globals_1 = _$$_REQUIRE(_dependencyMap[0], \"./globals\");\n\n  var constants_1 = _$$_REQUIRE(_dependencyMap[1], \"./constants\");\n\n  var attach_listener_1 = _$$_REQUIRE(_dependencyMap[2], \"./attach-listener\");\n\n  var attach_shared_listeners_1 = _$$_REQUIRE(_dependencyMap[3], \"./attach-shared-listeners\");\n\n  var manage_subscribers_1 = _$$_REQUIRE(_dependencyMap[4], \"./manage-subscribers\");\n\n  var cleanSubscribers = function cleanSubscribers(url, subscriber, optionsRef, setReadyState) {\n    return function () {\n      manage_subscribers_1.removeSubscriber(url, subscriber);\n\n      if (!manage_subscribers_1.hasSubscribers(url)) {\n        try {\n          globals_1.sharedWebSockets[url].onclose = function (event) {\n            if (optionsRef.current.onClose) {\n              optionsRef.current.onClose(event);\n            }\n\n            setReadyState(constants_1.ReadyState.CLOSED);\n          };\n\n          globals_1.sharedWebSockets[url].close();\n        } catch (e) {}\n\n        delete globals_1.sharedWebSockets[url];\n      }\n    };\n  };\n\n  exports.createOrJoinSocket = function (webSocketRef, url, setReadyState, optionsRef, setLastMessage, startRef, reconnectCount) {\n    if (optionsRef.current.share) {\n      if (globals_1.sharedWebSockets[url] === undefined) {\n        setReadyState(constants_1.ReadyState.CONNECTING);\n        globals_1.sharedWebSockets[url] = new WebSocket(url, optionsRef.current.protocols);\n        attach_shared_listeners_1.attachSharedListeners(globals_1.sharedWebSockets[url], url);\n      } else {\n        setReadyState(globals_1.sharedWebSockets[url].readyState);\n      }\n\n      var subscriber = {\n        setLastMessage: setLastMessage,\n        setReadyState: setReadyState,\n        optionsRef: optionsRef,\n        reconnectCount: reconnectCount,\n        reconnect: startRef\n      };\n      manage_subscribers_1.addSubscriber(url, subscriber);\n      webSocketRef.current = globals_1.sharedWebSockets[url];\n      return cleanSubscribers(url, subscriber, optionsRef, setReadyState);\n    } else {\n      setReadyState(constants_1.ReadyState.CONNECTING);\n      webSocketRef.current = new WebSocket(url, optionsRef.current.protocols);\n      return attach_listener_1.attachListeners(webSocketRef.current, {\n        setLastMessage: setLastMessage,\n        setReadyState: setReadyState\n      }, optionsRef, startRef.current, reconnectCount);\n    }\n  };\n});","lineCount":70,"map":[[2,0,1,0],[4,0,2,0,"Object"],[4,2,2,0,"Object"],[4,8,2,6],[4,9,2,7,"defineProperty"],[4,23,2,0],[4,24,2,22,"exports"],[4,31,2,0],[4,33,2,31],[4,45,2,0],[4,47,2,45],[5,0,2,47,"value"],[5,4,2,47,"value"],[5,9,2,52],[5,11,2,54],[6,0,2,45],[6,3,2,0],[7,0,3,0,"exports"],[7,2,3,0,"exports"],[7,9,3,7],[7,10,3,8,"createOrJoinSocket"],[7,28,3,0],[7,31,3,29],[7,36,3,34],[7,37,3,0],[9,0,4,0],[9,6,4,4,"globals_1"],[9,15,4,13],[9,18,4,16,"require"],[9,29,4,23],[9,61,4,0],[11,0,5,0],[11,6,5,4,"constants_1"],[11,17,5,15],[11,20,5,18,"require"],[11,31,5,25],[11,65,5,0],[13,0,6,0],[13,6,6,4,"attach_listener_1"],[13,23,6,21],[13,26,6,24,"require"],[13,37,6,31],[13,77,6,0],[15,0,7,0],[15,6,7,4,"attach_shared_listeners_1"],[15,31,7,29],[15,34,7,32,"require"],[15,45,7,39],[15,93,7,0],[17,0,8,0],[17,6,8,4,"manage_subscribers_1"],[17,26,8,24],[17,29,8,27,"require"],[17,40,8,34],[17,83,8,0],[19,0,10,0],[19,6,10,4,"cleanSubscribers"],[19,22,10,20],[19,25,10,23],[19,34,10,4,"cleanSubscribers"],[19,50,10,23],[19,51,10,33,"url"],[19,54,10,23],[19,56,10,38,"subscriber"],[19,66,10,23],[19,68,10,50,"optionsRef"],[19,78,10,23],[19,80,10,62,"setReadyState"],[19,93,10,23],[19,95,10,77],[20,0,11,4],[20,11,11,11],[20,23,11,23],[21,0,12,8,"manage_subscribers_1"],[21,6,12,8,"manage_subscribers_1"],[21,26,12,28],[21,27,12,29,"removeSubscriber"],[21,43,12,8],[21,44,12,46,"url"],[21,47,12,8],[21,49,12,51,"subscriber"],[21,59,12,8],[23,0,13,8],[23,10,13,12],[23,11,13,13,"manage_subscribers_1"],[23,31,13,33],[23,32,13,34,"hasSubscribers"],[23,46,13,13],[23,47,13,49,"url"],[23,50,13,13],[23,51,13,8],[23,53,13,55],[24,0,14,12],[24,12,14,16],[25,0,15,16,"globals_1"],[25,10,15,16,"globals_1"],[25,19,15,25],[25,20,15,26,"sharedWebSockets"],[25,36,15,16],[25,37,15,43,"url"],[25,40,15,16],[25,42,15,48,"onclose"],[25,49,15,16],[25,52,15,58],[25,62,15,68,"event"],[25,67,15,58],[25,69,15,75],[26,0,16,20],[26,16,16,24,"optionsRef"],[26,26,16,34],[26,27,16,35,"current"],[26,34,16,24],[26,35,16,43,"onClose"],[26,42,16,20],[26,44,16,52],[27,0,17,24,"optionsRef"],[27,14,17,24,"optionsRef"],[27,24,17,34],[27,25,17,35,"current"],[27,32,17,24],[27,33,17,43,"onClose"],[27,40,17,24],[27,41,17,51,"event"],[27,46,17,24],[28,0,18,21],[30,0,19,20,"setReadyState"],[30,12,19,20,"setReadyState"],[30,25,19,33],[30,26,19,34,"constants_1"],[30,37,19,45],[30,38,19,46,"ReadyState"],[30,48,19,34],[30,49,19,57,"CLOSED"],[30,55,19,33],[30,56,19,20],[31,0,20,17],[31,11,15,16],[33,0,21,16,"globals_1"],[33,10,21,16,"globals_1"],[33,19,21,25],[33,20,21,26,"sharedWebSockets"],[33,36,21,16],[33,37,21,43,"url"],[33,40,21,16],[33,42,21,48,"close"],[33,47,21,16],[34,0,22,13],[34,9,14,12],[34,10,23,12],[34,17,23,19,"e"],[34,18,23,12],[34,20,23,22],[34,21,24,13],[36,0,25,12],[36,15,25,19,"globals_1"],[36,24,25,28],[36,25,25,29,"sharedWebSockets"],[36,41,25,19],[36,42,25,46,"url"],[36,45,25,19],[36,46,25,12],[37,0,26,9],[38,0,27,5],[38,5,11,4],[39,0,28,1],[39,3,10,0],[41,0,29,0,"exports"],[41,2,29,0,"exports"],[41,9,29,7],[41,10,29,8,"createOrJoinSocket"],[41,28,29,0],[41,31,29,29],[41,41,29,39,"webSocketRef"],[41,53,29,29],[41,55,29,53,"url"],[41,58,29,29],[41,60,29,58,"setReadyState"],[41,73,29,29],[41,75,29,73,"optionsRef"],[41,85,29,29],[41,87,29,85,"setLastMessage"],[41,101,29,29],[41,103,29,101,"startRef"],[41,111,29,29],[41,113,29,111,"reconnectCount"],[41,127,29,29],[41,129,29,127],[42,0,30,4],[42,8,30,8,"optionsRef"],[42,18,30,18],[42,19,30,19,"current"],[42,26,30,8],[42,27,30,27,"share"],[42,32,30,4],[42,34,30,34],[43,0,31,8],[43,10,31,12,"globals_1"],[43,19,31,21],[43,20,31,22,"sharedWebSockets"],[43,36,31,12],[43,37,31,39,"url"],[43,40,31,12],[43,46,31,48,"undefined"],[43,55,31,8],[43,57,31,59],[44,0,32,12,"setReadyState"],[44,8,32,12,"setReadyState"],[44,21,32,25],[44,22,32,26,"constants_1"],[44,33,32,37],[44,34,32,38,"ReadyState"],[44,44,32,26],[44,45,32,49,"CONNECTING"],[44,55,32,25],[44,56,32,12],[45,0,33,12,"globals_1"],[45,8,33,12,"globals_1"],[45,17,33,21],[45,18,33,22,"sharedWebSockets"],[45,34,33,12],[45,35,33,39,"url"],[45,38,33,12],[45,42,33,46],[45,46,33,50,"WebSocket"],[45,55,33,46],[45,56,33,60,"url"],[45,59,33,46],[45,61,33,65,"optionsRef"],[45,71,33,75],[45,72,33,76,"current"],[45,79,33,65],[45,80,33,84,"protocols"],[45,89,33,46],[45,90,33,12],[46,0,34,12,"attach_shared_listeners_1"],[46,8,34,12,"attach_shared_listeners_1"],[46,33,34,37],[46,34,34,38,"attachSharedListeners"],[46,55,34,12],[46,56,34,60,"globals_1"],[46,65,34,69],[46,66,34,70,"sharedWebSockets"],[46,82,34,60],[46,83,34,87,"url"],[46,86,34,60],[46,87,34,12],[46,89,34,93,"url"],[46,92,34,12],[47,0,35,9],[47,7,31,8],[47,13,36,13],[48,0,37,12,"setReadyState"],[48,8,37,12,"setReadyState"],[48,21,37,25],[48,22,37,26,"globals_1"],[48,31,37,35],[48,32,37,36,"sharedWebSockets"],[48,48,37,26],[48,49,37,53,"url"],[48,52,37,26],[48,54,37,58,"readyState"],[48,64,37,25],[48,65,37,12],[49,0,38,9],[51,0,39,8],[51,10,39,12,"subscriber"],[51,20,39,22],[51,23,39,25],[52,0,40,12,"setLastMessage"],[52,8,40,12,"setLastMessage"],[52,22,40,26],[52,24,40,28,"setLastMessage"],[52,38,39,25],[53,0,41,12,"setReadyState"],[53,8,41,12,"setReadyState"],[53,21,41,25],[53,23,41,27,"setReadyState"],[53,36,39,25],[54,0,42,12,"optionsRef"],[54,8,42,12,"optionsRef"],[54,18,42,22],[54,20,42,24,"optionsRef"],[54,30,39,25],[55,0,43,12,"reconnectCount"],[55,8,43,12,"reconnectCount"],[55,22,43,26],[55,24,43,28,"reconnectCount"],[55,38,39,25],[56,0,44,12,"reconnect"],[56,8,44,12,"reconnect"],[56,17,44,21],[56,19,44,23,"startRef"],[57,0,39,25],[57,7,39,8],[58,0,46,8,"manage_subscribers_1"],[58,6,46,8,"manage_subscribers_1"],[58,26,46,28],[58,27,46,29,"addSubscriber"],[58,40,46,8],[58,41,46,43,"url"],[58,44,46,8],[58,46,46,48,"subscriber"],[58,56,46,8],[59,0,47,8,"webSocketRef"],[59,6,47,8,"webSocketRef"],[59,18,47,20],[59,19,47,21,"current"],[59,26,47,8],[59,29,47,31,"globals_1"],[59,38,47,40],[59,39,47,41,"sharedWebSockets"],[59,55,47,31],[59,56,47,58,"url"],[59,59,47,31],[59,60,47,8],[60,0,48,8],[60,13,48,15,"cleanSubscribers"],[60,29,48,31],[60,30,48,32,"url"],[60,33,48,31],[60,35,48,37,"subscriber"],[60,45,48,31],[60,47,48,49,"optionsRef"],[60,57,48,31],[60,59,48,61,"setReadyState"],[60,72,48,31],[60,73,48,8],[61,0,49,5],[61,5,30,4],[61,11,50,9],[62,0,51,8,"setReadyState"],[62,6,51,8,"setReadyState"],[62,19,51,21],[62,20,51,22,"constants_1"],[62,31,51,33],[62,32,51,34,"ReadyState"],[62,42,51,22],[62,43,51,45,"CONNECTING"],[62,53,51,21],[62,54,51,8],[63,0,52,8,"webSocketRef"],[63,6,52,8,"webSocketRef"],[63,18,52,20],[63,19,52,21,"current"],[63,26,52,8],[63,29,52,31],[63,33,52,35,"WebSocket"],[63,42,52,31],[63,43,52,45,"url"],[63,46,52,31],[63,48,52,50,"optionsRef"],[63,58,52,60],[63,59,52,61,"current"],[63,66,52,50],[63,67,52,69,"protocols"],[63,76,52,31],[63,77,52,8],[64,0,53,8],[64,13,53,15,"attach_listener_1"],[64,30,53,32],[64,31,53,33,"attachListeners"],[64,46,53,15],[64,47,53,49,"webSocketRef"],[64,59,53,61],[64,60,53,62,"current"],[64,67,53,15],[64,69,53,71],[65,0,54,12,"setLastMessage"],[65,8,54,12,"setLastMessage"],[65,22,54,26],[65,24,54,28,"setLastMessage"],[65,38,53,71],[66,0,55,12,"setReadyState"],[66,8,55,12,"setReadyState"],[66,21,55,25],[66,23,55,27,"setReadyState"],[67,0,53,71],[67,7,53,15],[67,9,56,11,"optionsRef"],[67,19,53,15],[67,21,56,23,"startRef"],[67,29,56,31],[67,30,56,32,"current"],[67,37,53,15],[67,39,56,41,"reconnectCount"],[67,53,53,15],[67,54,53,8],[68,0,57,5],[69,0,58,1],[69,3,29,0]],"functionMap":{"names":["<global>","cleanSubscribers","<anonymous>","globals_1.sharedWebSockets.url.onclose","exports.createOrJoinSocket"],"mappings":"AAA;uBCS;WCC;0DCI;iBDK;KDO;CDC;6BIC;CJ6B"}},"type":"js/module"}]}